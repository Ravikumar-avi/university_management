<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Form View - Hackathon Team -->
    <record id="hackathon_team_view_form" model="ir.ui.view">
        <field name="name">hackathon.team.view.form</field>
        <field name="model">hackathon.team</field>
        <field name="arch" type="xml">
            <form string="Hackathon Team">
                <header>
                    <button name="action_register" string="Register" type="object"
                            class="btn-primary"
                            invisible="state != 'draft'"
                            confirm="Register this team for the hackathon?"/>
                    <button name="action_approve" string="Approve" type="object"
                            class="btn-success"
                            invisible="state != 'registered'"
                            confirm="Approve this team?"/>
                    <button name="action_disqualify" string="Disqualify" type="object"
                            class="btn-danger"
                            invisible="state in ['draft', 'disqualified']"
                            confirm="Are you sure you want to disqualify this team?"/>
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,registered,approved"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_team_members" type="object"
                                class="oe_stat_button"
                                icon="fa-users">
                            <field name="team_size" widget="statinfo"
                                   string="Members"/>
                        </button>
                    </div>

                    <div class="oe_title">
                        <label for="name" string="Team Name"/>
                        <h1>
                            <field name="name" placeholder="e.g., Code Warriors"/>
                        </h1>
                        <div class="o_row">
                            <field name="code" readonly="1"/>
                        </div>
                    </div>

                    <group>
                        <group string="Hackathon Details">
                            <field name="hackathon_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="registration_date" readonly="1"/>
                        </group>
                        <group string="Team Leader">
                            <field name="team_leader_id"
                                   context="{'default_is_student': True}"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Team Members" name="members">
                            <field name="member_ids" widget="many2many_tags"
                                   context="{'default_is_student': True}"
                                   options="{'no_create': True, 'no_create_edit': True, 'color_field': 'color'}">
                                <list>
                                    <field name="name"/>
                                    <field name="registration_number"/>
                                    <field name="program_id"/>
                                    <field name="email"/>
                                    <field name="phone"/>
                                </list>
                            </field>
                        </page>

                        <page string="Project Details" name="project">
                            <group>
                                <group string="Project Information">
                                    <field name="project_title"
                                           placeholder="e.g., AI-Powered Healthcare Assistant"/>
                                </group>
                            </group>
                            <group>
                                <field name="project_description" nolabel="1"
                                       placeholder="Describe your project idea, objectives, features, etc..."/>
                            </group>
                            <group>
                                <group string="Technologies">
                                    <field name="technologies" nolabel="1"
                                           placeholder="List the technologies, frameworks, languages, tools you plan to use (e.g., Python, React, TensorFlow, AWS, etc.)"/>
                                </group>
                            </group>
                        </page>

                        <page string="Submission" name="submission">
                            <group>
                                <group string="Code Repository">
                                    <field name="github_repo"
                                           widget="url"
                                           placeholder="https://github.com/username/project"/>
                                </group>
                                <group string="Demo">
                                    <field name="demo_url"
                                           widget="url"
                                           placeholder="https://demo.example.com"/>
                                    <field name="video_url"
                                           widget="url"
                                           placeholder="https://youtube.com/watch?v=xxxxx"/>
                                </group>
                            </group>
                            <group>
                                <group string="Presentation">
                                    <field name="presentation"
                                           filename="presentation_filename"/>
                                    <field name="submission_date" readonly="1"/>
                                </group>
                            </group>
                        </page>

                        <page string="Evaluation" name="evaluation">
                            <group>
                                <group string="Score">
                                    <field name="score" readonly="1"/>
                                </group>
                            </group>
                            <group>
                                <field name="remarks" nolabel="1"
                                       placeholder="Add evaluation remarks, feedback, suggestions, etc..."/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View - Hackathon Team -->
    <record id="hackathon_team_view_list" model="ir.ui.view">
        <field name="name">hackathon.team.view.list</field>
        <field name="model">hackathon.team</field>
        <field name="arch" type="xml">
            <list string="Hackathon Teams"
                  default_order="registration_date desc"
                  multi_edit="1"
                  sample="1"
                  decoration-info="state == 'draft'"
                  decoration-primary="state == 'registered'"
                  decoration-success="state == 'approved'"
                  decoration-muted="state == 'disqualified'">
                <field name="code"/>
                <field name="name"/>
                <field name="hackathon_id"/>
                <field name="team_leader_id"/>
                <field name="team_size" optional="show"/>
                <field name="project_title" optional="show"/>
                <field name="registration_date" optional="show"/>
                <field name="submission_date" optional="hide"/>
                <field name="score" optional="show"/>
                <field name="state" widget="badge"
                       decoration-info="state == 'draft'"
                       decoration-primary="state == 'registered'"
                       decoration-success="state == 'approved'"
                       decoration-muted="state == 'disqualified'"/>
            </list>
        </field>
    </record>

    <!-- Search View - Hackathon Team -->
    <record id="hackathon_team_view_search" model="ir.ui.view">
        <field name="name">hackathon.team.view.search</field>
        <field name="model">hackathon.team</field>
        <field name="arch" type="xml">
            <search string="Search Teams">
                <field name="name"/>
                <field name="code"/>
                <field name="hackathon_id"/>
                <field name="team_leader_id"/>
                <field name="project_title"/>

                <separator/>

                <filter name="filter_draft" string="Draft"
                        domain="[('state', '=', 'draft')]"/>
                <filter name="filter_registered" string="Registered"
                        domain="[('state', '=', 'registered')]"/>
                <filter name="filter_approved" string="Approved"
                        domain="[('state', '=', 'approved')]"/>
                <filter name="filter_disqualified" string="Disqualified"
                        domain="[('state', '=', 'disqualified')]"/>

                <separator/>

                <filter name="filter_submitted" string="Submitted"
                        domain="[('submission_date', '!=', False)]"/>
                <filter name="filter_not_submitted" string="Not Submitted"
                        domain="[('submission_date', '=', False)]"/>

                <separator/>

                <filter name="filter_this_week" string="Registered This Week"
                        domain="[('registration_date', '&gt;=', (context_today() - datetime.timedelta(days=7)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_month" string="Registered This Month"
                        domain="[('registration_date', '&gt;=', (context_today().replace(day=1)).strftime('%Y-%m-%d'))]"/>

                <group expand="0" string="Group By">
                    <filter name="group_by_hackathon" string="Hackathon"
                            context="{'group_by': 'hackathon_id'}"/>
                    <filter name="group_by_state" string="Status"
                            context="{'group_by': 'state'}"/>
                    <filter name="group_by_registration_date" string="Registration Date"
                            context="{'group_by': 'registration_date'}"/>
                </group>

                <searchpanel>
                    <field name="hackathon_id" string="Hackathon"
                           icon="fa-trophy"/>
                    <field name="state" string="Status"
                           select="multi"
                           icon="fa-flag"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Kanban View - Hackathon Team -->
    <record id="hackathon_team_view_kanban" model="ir.ui.view">
        <field name="name">hackathon.team.view.kanban</field>
        <field name="model">hackathon.team</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile"
                    default_group_by="state"
                    quick_create="false"
                    sample="1">
                <field name="id"/>
                <field name="name"/>
                <field name="code"/>
                <field name="hackathon_id"/>
                <field name="team_leader_id"/>
                <field name="team_size"/>
                <field name="project_title"/>
                <field name="registration_date"/>
                <field name="submission_date"/>
                <field name="score"/>
                <field name="state"/>
                <field name="activity_ids"/>

                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <field name="name"/>
                                        </strong>
                                        <div class="text-muted mt-1">
                                            <small><field name="code"/></small>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_body mt-3">
                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded">
                                                <small class="text-muted">Hackathon</small>
                                                <h6 class="mb-0">
                                                    <i class="fa fa-trophy text-warning"/> <field name="hackathon_id"/>
                                                </h6>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded">
                                                <small class="text-muted">Team Leader</small>
                                                <h6 class="mb-0">
                                                    <i class="fa fa-user-circle text-primary"/> <field name="team_leader_id"/>
                                                </h6>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <h4 class="mb-0 text-success">
                                                    <field name="team_size"/>
                                                </h4>
                                                <small class="text-muted">Members</small>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <h4 class="mb-0 text-info">
                                                    <field name="score"/>
                                                </h4>
                                                <small class="text-muted">Score</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.project_title.raw_value">
                                        <div class="col-12">
                                            <div class="alert alert-info mb-0 p-2">
                                                <small class="text-muted d-block mb-1">
                                                    <strong>Project</strong>
                                                </small>
                                                <small>
                                                    <i class="fa fa-lightbulb-o"/> <field name="project_title"/>
                                                </small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded">
                                                <div class="row">
                                                    <div class="col-6">
                                                        <small class="text-muted">Registered</small>
                                                        <div>
                                                            <small>
                                                                <i class="fa fa-calendar text-primary"/>
                                                                <field name="registration_date" widget="date"/>
                                                            </small>
                                                        </div>
                                                    </div>
                                                    <div class="col-6" t-if="record.submission_date.raw_value">
                                                        <small class="text-muted">Submitted</small>
                                                        <div>
                                                            <small>
                                                                <i class="fa fa-check text-success"/>
                                                                <field name="submission_date" widget="date"/>
                                                            </small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_bottom mt-2">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Action -->
    <record id="action_hackathon_team" model="ir.actions.act_window">
        <field name="name">Teams</field>
        <field name="res_model">hackathon.team</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="context">{'search_default_filter_registered': 1, 'search_default_group_by_hackathon': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Register Hackathon Team
            </p>
            <p>
                Manage hackathon team registrations with comprehensive features. Auto-generated unique code
                (Team Code, readonly sequence). Enter name (char required tracked, placeholder "e.g., Code
                Warriors"). Select hackathon_id (Many2one to hackathon.hackathon required tracked indexed,
                no-create). Select team_leader_id (Many2one to student.student required tracked,
                default_is_student context, no-create). Add member_ids (Many2many to student.student with
                relation hackathon_team_member_rel team_id student_id, many2many_tags widget with
                default_is_student context and no-create and color_field options, list showing name/
                registration_number/program_id/email/phone). View team_size (integer computed via
                _compute_team_size with api.depends('member_ids','team_leader_id') counting
                member_ids|team_leader_id, displayed in statinfo button with icon fa-users). Enter
                project_title (char tracked, placeholder "e.g., AI-Powered Healthcare Assistant"). Enter
                project_description (html, placeholder "Describe your project idea, objectives, features,
                etc..."). Enter technologies (text, placeholder "List the technologies, frameworks,
                languages, tools you plan to use (e.g., Python, React, TensorFlow, AWS, etc.)"). Enter
                github_repo (char, url widget, placeholder "https://github.com/username/project"). Enter
                demo_url (char, url widget, placeholder "https://demo.example.com"). Enter video_url (char,
                url widget, placeholder "https://youtube.com/watch?v=xxxxx"). Upload presentation (binary
                attachment with filename presentation_filename). View submission_date (datetime readonly).
                View score (float computed stored readonly via _compute_score with
                api.depends('hackathon_id.judge_ids'), default 0.0). View registration_date (datetime
                default now readonly). Select state (4 options default draft tracked): draft/registered/
                approved/disqualified. Enter remarks (text, placeholder "Add evaluation remarks, feedback,
                suggestions, etc..."). Header has 3 workflow action buttons: Register (draft→registered with
                confirmation "Register this team for the hackathon?", primary), Approve (registered→approved
                with confirmation "Approve this team?", success), Disqualify (any→disqualified except draft/
                disqualified with confirmation "Are you sure you want to disqualify this team?", danger).
                Statusbar widget for state (visible draft,registered,approved). Form view with button_box
                containing team_size statinfo, notebook having 4 pages: Team Members (member_ids
                many2many_tags with list), Project Details (project_title/project_description/technologies),
                Submission (github_repo/demo_url/video_url/presentation/submission_date), Evaluation
                (score/remarks). List view with 4-color row decorations: Info (draft), Primary/Blue
                (registered), Success/Green (approved), Muted/Gray (disqualified). Badge widget for state
                with 4-color decorations. Optional field controls. Kanban view grouped by state showing name
                as title with code small text, hackathon_id card (light background, trophy icon warning,
                small "Hackathon" label), team_leader_id card (light background, user-circle icon primary,
                small "Team Leader" label), 2-card grid (6/6) showing team_size h4 success with "Members"
                small text and score h4 info with "Score" small text, conditional project_title alert (info/
                blue background, small "Project" bold label, lightbulb-o icon with project_title, shown if
                project_title exists), registration_date and conditional submission_date card (light
                background, 2-column grid showing "Registered" calendar icon primary with registration_date
                date widget, "Submitted" check icon success with submission_date date widget if exists),
                activity widget at bottom-right. Ordered by registration_date desc (most recent first).
                Default filters: Registered and grouped by Hackathon. Comprehensive search filters for 4
                states/submitted-not submitted/this week-this month/group by hackathon-state-registration_date.
                Searchpanel for hackathon_id and state multi-select. Full chatter/activity/portal support. 2
                SQL constraints: unique code and unique name per hackathon. Team size validation constraint
                via _check_team_size with api.constrains('team_size','hackathon_id') checking
                hackathon.team_size_min and hackathon.team_size_max. Complete team registration lifecycle
                management.
            </p>
        </field>
    </record>

    <!-- Menu Item -->
<!--    <menuitem id="menu_hackathon_team"-->
<!--              name="Teams"-->
<!--              parent="menu_events_root"-->
<!--              action="action_hackathon_team"-->
<!--              sequence="60"/>-->

</odoo>
