<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Form View -->
    <record id="faculty_salary_view_form" model="ir.ui.view">
        <field name="name">faculty.salary.view.form</field>
        <field name="model">faculty.salary</field>
        <field name="arch" type="xml">
            <form string="Faculty Salary">
                <header>
                    <button name="action_verify" type="object" string="Verify"
                            class="oe_highlight"
                            invisible="state != 'draft'"/>
                    <button name="action_approve" type="object" string="Approve"
                            class="oe_highlight"
                            invisible="state != 'verified'"/>
                    <button name="action_mark_paid" type="object" string="Mark as Paid"
                            class="oe_highlight"
                            invisible="state != 'approved'"/>
                    <button name="action_print_salary_slip" type="object" string="Print Salary Slip"
                            class="btn-secondary"
                            invisible="state == 'draft'"/>
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,verified,approved,paid"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name" string="Salary Slip Number"/>
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Faculty Information">
                            <field name="faculty_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="employee_id" readonly="1" invisible="1"/>
                            <field name="department_id" readonly="1"/>
                            <field name="designation_id" readonly="1"/>
                        </group>
                        <group string="Salary Period">
                            <field name="month"/>
                            <field name="year"/>
                            <field name="payment_date" widget="date"/>
                            <field name="currency_id" invisible="1"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Earnings" name="earnings">
                            <group>
                                <group string="Basic &amp; Allowances">
                                    <field name="basic_salary" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="hra" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="da" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="special_allowance" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <group string="Additional Allowances">
                                    <field name="transport_allowance" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="medical_allowance" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="other_allowances" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>

                            <separator string="Bonus &amp; Incentives"/>

                            <group>
                                <group>
                                    <field name="performance_bonus" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <group>
                                    <field name="overtime_pay" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>

                            <separator/>

                            <group>
                                <group>
                                    <field name="total_earnings" readonly="1" widget="monetary"
                                           class="oe_read_only"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                        </page>

                        <page string="Deductions" name="deductions">
                            <group>
                                <group string="Statutory Deductions">
                                    <field name="pf" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="esi" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="professional_tax" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="income_tax" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <group string="Other Deductions">
                                    <field name="advance_deduction" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="loan_deduction" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="other_deductions" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>

                            <separator string="Leave Deductions"/>

                            <group>
                                <group>
                                    <field name="leave_without_pay_days" widget="float"/>
                                    <field name="leave_deduction" readonly="1" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>

                            <separator/>

                            <group>
                                <group>
                                    <field name="total_deductions" readonly="1" widget="monetary"
                                           class="oe_read_only"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                        </page>

                        <page string="Net Salary" name="net_salary">
                            <group>
                                <group string="Summary">
                                    <field name="total_earnings" readonly="1" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="total_deductions" readonly="1" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>

                            <separator/>

                            <group>
                                <group>
                                    <field name="net_salary" readonly="1" widget="monetary"
                                           class="oe_read_only fw-bold"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                        </page>

                        <page string="Payment Details" name="payment">
                            <group>
                                <group string="Payment Information">
                                    <field name="payment_method" widget="radio"/>
                                    <field name="payment_reference"/>
                                </group>
                                <group string="Bank Details">
                                    <field name="bank_account_number" readonly="1"/>
                                    <field name="bank_name" readonly="1"/>
                                </group>
                            </group>
                        </page>

                        <page string="Notes" name="notes">
                            <field name="notes"
                                   placeholder="Enter any additional notes or remarks..."/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View -->
    <record id="faculty_salary_view_list" model="ir.ui.view">
        <field name="name">faculty.salary.view.list</field>
        <field name="model">faculty.salary</field>
        <field name="arch" type="xml">
            <list string="Faculty Salaries"
                  default_order="payment_date desc"
                  multi_edit="1"
                  sample="1"
                  decoration-success="state == 'paid'"
                  decoration-info="state == 'approved'"
                  decoration-warning="state == 'verified'"
                  decoration-muted="state == 'draft'">
                <field name="name"/>
                <field name="faculty_id"/>
                <field name="department_id" optional="show"/>
                <field name="designation_id" optional="hide"/>
                <field name="month"/>
                <field name="year"/>
                <field name="payment_date" optional="show"/>
                <field name="basic_salary" optional="hide" sum="Total Basic"/>
                <field name="total_earnings" optional="show" sum="Total Earnings"/>
                <field name="total_deductions" optional="show" sum="Total Deductions"/>
                <field name="net_salary" sum="Total Net Salary"/>
                <field name="payment_method" optional="hide"/>
                <field name="currency_id" column_invisible="1"/>
                <field name="state" widget="badge"
                       decoration-success="state == 'paid'"
                       decoration-info="state == 'approved'"
                       decoration-warning="state == 'verified'"
                       decoration-muted="state == 'draft'"/>
            </list>
        </field>
    </record>

    <!-- Search View -->
    <record id="faculty_salary_view_search" model="ir.ui.view">
        <field name="name">faculty.salary.view.search</field>
        <field name="model">faculty.salary</field>
        <field name="arch" type="xml">
            <search string="Search Faculty Salaries">
                <field name="name"/>
                <field name="faculty_id"/>
                <field name="department_id"/>
                <field name="designation_id"/>
                <field name="month"/>
                <field name="year"/>

                <separator/>

                <filter name="filter_draft" string="Draft"
                        domain="[('state', '=', 'draft')]"/>
                <filter name="filter_verified" string="Verified"
                        domain="[('state', '=', 'verified')]"/>
                <filter name="filter_approved" string="Approved"
                        domain="[('state', '=', 'approved')]"/>
                <filter name="filter_paid" string="Paid"
                        domain="[('state', '=', 'paid')]"/>

                <separator/>

                <filter name="filter_bank_transfer" string="Bank Transfer"
                        domain="[('payment_method', '=', 'bank_transfer')]"/>
                <filter name="filter_cheque" string="Cheque"
                        domain="[('payment_method', '=', 'cheque')]"/>
                <filter name="filter_cash" string="Cash"
                        domain="[('payment_method', '=', 'cash')]"/>

                <separator/>

                <filter name="filter_january" string="January"
                        domain="[('month', '=', '1')]"/>
                <filter name="filter_february" string="February"
                        domain="[('month', '=', '2')]"/>
                <filter name="filter_march" string="March"
                        domain="[('month', '=', '3')]"/>
                <filter name="filter_april" string="April"
                        domain="[('month', '=', '4')]"/>
                <filter name="filter_may" string="May"
                        domain="[('month', '=', '5')]"/>
                <filter name="filter_june" string="June"
                        domain="[('month', '=', '6')]"/>
                <filter name="filter_july" string="July"
                        domain="[('month', '=', '7')]"/>
                <filter name="filter_august" string="August"
                        domain="[('month', '=', '8')]"/>
                <filter name="filter_september" string="September"
                        domain="[('month', '=', '9')]"/>
                <filter name="filter_october" string="October"
                        domain="[('month', '=', '10')]"/>
                <filter name="filter_november" string="November"
                        domain="[('month', '=', '11')]"/>
                <filter name="filter_december" string="December"
                        domain="[('month', '=', '12')]"/>

                <separator/>

                <filter name="filter_this_month" string="This Month"
                        domain="[('month', '=', str(context_today().month)),
                                 ('year', '=', context_today().year)]"/>
                <filter name="filter_this_year" string="This Year"
                        domain="[('year', '=', context_today().year)]"/>

                <group expand="0" string="Group By">
                    <filter name="group_by_faculty" string="Faculty"
                            context="{'group_by': 'faculty_id'}"/>
                    <filter name="group_by_department" string="Department"
                            context="{'group_by': 'department_id'}"/>
                    <filter name="group_by_designation" string="Designation"
                            context="{'group_by': 'designation_id'}"/>
                    <filter name="group_by_month" string="Month"
                            context="{'group_by': 'month'}"/>
                    <filter name="group_by_year" string="Year"
                            context="{'group_by': 'year'}"/>
                    <filter name="group_by_payment_method" string="Payment Method"
                            context="{'group_by': 'payment_method'}"/>
                    <filter name="group_by_state" string="Status"
                            context="{'group_by': 'state'}"/>
                    <filter name="group_by_payment_date" string="Payment Date"
                            context="{'group_by': 'payment_date'}"/>
                </group>

                <searchpanel>
                    <field name="department_id" string="Department"
                           select="multi"
                           icon="fa-building"/>
                    <field name="month" string="Month"
                           select="multi"
                           icon="fa-calendar"/>
                    <field name="state" string="Status"
                           select="multi"
                           icon="fa-filter"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Kanban View -->
    <record id="faculty_salary_view_kanban" model="ir.ui.view">
        <field name="name">faculty.salary.view.kanban</field>
        <field name="model">faculty.salary</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile"
                    default_group_by="state"
                    quick_create="false"
                    sample="1">
                <field name="id"/>
                <field name="name"/>
                <field name="faculty_id"/>
                <field name="department_id"/>
                <field name="designation_id"/>
                <field name="month"/>
                <field name="year"/>
                <field name="payment_date"/>
                <field name="basic_salary"/>
                <field name="total_earnings"/>
                <field name="total_deductions"/>
                <field name="net_salary"/>
                <field name="payment_method"/>
                <field name="currency_id"/>
                <field name="state"/>

                <progressbar field="state"
                             colors='{"draft": "muted", "verified": "warning", "approved": "info", "paid": "success"}'/>

                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <field name="faculty_id"/>
                                        </strong>
                                        <div class="text-muted">
                                            <field name="name"/>
                                        </div>
                                    </div>
                                    <div class="o_kanban_record_top_right">
                                        <field name="state" widget="badge"
                                               decoration-success="state == 'paid'"
                                               decoration-info="state == 'approved'"
                                               decoration-warning="state == 'verified'"
                                               decoration-muted="state == 'draft'"/>
                                    </div>
                                </div>

                                <div class="o_kanban_record_body">
                                    <div class="row mb-2">
                                        <div class="col-6">
                                            <i class="fa fa-building text-primary"/>
                                            <field name="department_id"/>
                                        </div>
                                        <div class="col-6">
                                            <i class="fa fa-id-badge text-info"/>
                                            <field name="designation_id"/>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <i class="fa fa-calendar text-secondary"/>
                                            <strong><field name="month"/> - <field name="year"/></strong>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.payment_date.raw_value">
                                        <div class="col-12">
                                            <i class="fa fa-calendar-check-o text-success"/>
                                            Paid on: <field name="payment_date"/>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded">
                                                <div class="d-flex justify-content-between mb-1">
                                                    <small class="text-muted">Earnings:</small>
                                                    <strong class="text-success">
                                                        <field name="total_earnings" widget="monetary"/>
                                                    </strong>
                                                </div>
                                                <div class="d-flex justify-content-between mb-1">
                                                    <small class="text-muted">Deductions:</small>
                                                    <strong class="text-danger">
                                                        <field name="total_deductions" widget="monetary"/>
                                                    </strong>
                                                </div>
                                                <hr class="my-1"/>
                                                <div class="d-flex justify-content-between">
                                                    <strong>Net Salary:</strong>
                                                    <strong class="text-primary">
                                                        <field name="net_salary" widget="monetary"/>
                                                    </strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mt-2">
                                        <div class="col-12">
                                            <span class="badge text-bg-secondary">
                                                <i class="fa fa-credit-card"/> <field name="payment_method"/>
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_bottom">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Pivot View -->
    <record id="faculty_salary_view_pivot" model="ir.ui.view">
        <field name="name">faculty.salary.view.pivot</field>
        <field name="model">faculty.salary</field>
        <field name="arch" type="xml">
            <pivot string="Salary Analysis">
                <field name="department_id" type="row"/>
                <field name="month" type="col"/>
                <field name="net_salary" type="measure"/>
                <field name="total_earnings" type="measure"/>
                <field name="total_deductions" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View -->
    <record id="faculty_salary_view_graph" model="ir.ui.view">
        <field name="name">faculty.salary.view.graph</field>
        <field name="model">faculty.salary</field>
        <field name="arch" type="xml">
            <graph string="Salary Statistics" type="bar" stacked="True">
                <field name="month"/>
                <field name="total_earnings" type="measure"/>
                <field name="total_deductions" type="measure"/>
            </graph>
        </field>
    </record>

    <!-- Action -->
    <record id="action_faculty_salary" model="ir.actions.act_window">
        <field name="name">Faculty Salaries</field>
        <field name="res_model">faculty.salary</field>
        <field name="view_mode">list,kanban,form,pivot,graph</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create Faculty Salary
            </p>
            <p>
                Manage faculty salary with comprehensive components including basic salary,
                allowances (HRA, DA, special, transport, medical), bonuses, deductions
                (PF, ESI, professional tax, income tax, advances, loans), and automatic
                LWP deduction calculation. Track payment status through verification,
                approval, and payment stages.
            </p>
        </field>
    </record>

    <!-- Menu Item -->
<!--    <menuitem id="menu_faculty_salary"-->
<!--              name="Salaries"-->
<!--              parent="menu_faculty_root"-->
<!--              action="action_faculty_salary"-->
<!--              sequence="30"/>-->

</odoo>
