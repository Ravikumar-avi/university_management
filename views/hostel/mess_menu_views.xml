<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Form View - Mess Menu -->
    <record id="mess_menu_view_form" model="ir.ui.view">
        <field name="name">mess.menu.view.form</field>
        <field name="model">mess.menu</field>
        <field name="arch" type="xml">
            <form string="Mess Menu">
                <sheet>
                    <div class="oe_title">
                        <label for="name" string="Menu"/>
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Menu Details">
                            <field name="mess_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="date"/>
                            <field name="day_of_week" readonly="1"
                                   decoration-info="day_of_week in ['saturday', 'sunday']"/>
                        </group>
                        <group string="Meal Information">
                            <field name="meal_type" widget="radio"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Menu Items" name="menu_items">
                            <field name="item_ids" widget="many2many_tags"
                                   options="{'color_field': 'item_type', 'no_create': True}"/>
                        </page>
                        <page string="Description" name="description">
                            <field name="description"
                                   placeholder="Enter menu description, special instructions, allergen info, etc."/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View - Mess Menu -->
    <record id="mess_menu_view_list" model="ir.ui.view">
        <field name="name">mess.menu.view.list</field>
        <field name="model">mess.menu</field>
        <field name="arch" type="xml">
            <list string="Mess Menu"
                  default_order="date desc, meal_type"
                  multi_edit="1"
                  sample="1"
                  decoration-info="day_of_week in ['saturday', 'sunday']">
                <field name="date"/>
                <field name="day_of_week" widget="badge" optional="show"/>
                <field name="mess_id"/>
                <field name="meal_type" widget="badge"
                       decoration-warning="meal_type == 'breakfast'"
                       decoration-success="meal_type == 'lunch'"
                       decoration-info="meal_type == 'snacks'"
                       decoration-primary="meal_type == 'dinner'"/>
                <field name="item_ids" widget="many2many_tags" optional="show"/>
            </list>
        </field>
    </record>

    <!-- Search View - Mess Menu -->
    <record id="mess_menu_view_search" model="ir.ui.view">
        <field name="name">mess.menu.view.search</field>
        <field name="model">mess.menu</field>
        <field name="arch" type="xml">
            <search string="Search Menu">
                <field name="name"/>
                <field name="mess_id"/>
                <field name="date"/>
                <field name="meal_type"/>
                <field name="item_ids"/>

                <separator/>

                <filter name="filter_today" string="Today"
                        domain="[('date', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter name="filter_tomorrow" string="Tomorrow"
                        domain="[('date', '=', (context_today() + datetime.timedelta(days=1)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_week"
                        string="This Week"
                        domain="[('date', '>=', (context_today() - datetime.timedelta(days=7)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_next_week"
                        string="Next Week"
                        domain="[('date', '>=', (context_today() + datetime.timedelta(days=1)).strftime('%Y-%m-%d'))]"/>

                <separator/>

                <filter name="filter_breakfast" string="Breakfast"
                        domain="[('meal_type', '=', 'breakfast')]"/>
                <filter name="filter_lunch" string="Lunch"
                        domain="[('meal_type', '=', 'lunch')]"/>
                <filter name="filter_snacks" string="Snacks"
                        domain="[('meal_type', '=', 'snacks')]"/>
                <filter name="filter_dinner" string="Dinner"
                        domain="[('meal_type', '=', 'dinner')]"/>

                <separator/>

                <filter name="filter_monday" string="Monday"
                        domain="[('day_of_week', '=', 'monday')]"/>
                <filter name="filter_tuesday" string="Tuesday"
                        domain="[('day_of_week', '=', 'tuesday')]"/>
                <filter name="filter_wednesday" string="Wednesday"
                        domain="[('day_of_week', '=', 'wednesday')]"/>
                <filter name="filter_thursday" string="Thursday"
                        domain="[('day_of_week', '=', 'thursday')]"/>
                <filter name="filter_friday" string="Friday"
                        domain="[('day_of_week', '=', 'friday')]"/>
                <filter name="filter_saturday" string="Saturday"
                        domain="[('day_of_week', '=', 'saturday')]"/>
                <filter name="filter_sunday" string="Sunday"
                        domain="[('day_of_week', '=', 'sunday')]"/>

                <separator/>

                <filter name="filter_weekends" string="Weekends"
                        domain="[('day_of_week', 'in', ['saturday', 'sunday'])]"/>
                <filter name="filter_weekdays" string="Weekdays"
                        domain="[('day_of_week', 'not in', ['saturday', 'sunday'])]"/>

                <group expand="0" string="Group By">
                    <filter name="group_by_date" string="Date"
                            context="{'group_by': 'date'}"/>
                    <filter name="group_by_mess" string="Mess"
                            context="{'group_by': 'mess_id'}"/>
                    <filter name="group_by_meal_type" string="Meal Type"
                            context="{'group_by': 'meal_type'}"/>
                    <filter name="group_by_day" string="Day of Week"
                            context="{'group_by': 'day_of_week'}"/>
                </group>

                <searchpanel>
                    <field name="mess_id" string="Mess"
                           select="multi"
                           icon="fa-cutlery"/>
                    <field name="meal_type" string="Meal Type"
                           select="multi"
                           icon="fa-coffee"/>
                    <field name="day_of_week" string="Day"
                           select="multi"
                           icon="fa-calendar"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Kanban View - Mess Menu -->
    <record id="mess_menu_view_kanban" model="ir.ui.view">
        <field name="name">mess.menu.view.kanban</field>
        <field name="model">mess.menu</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile"
                    default_group_by="meal_type"
                    quick_create="false"
                    sample="1">
                <field name="id"/>
                <field name="name"/>
                <field name="mess_id"/>
                <field name="date"/>
                <field name="day_of_week"/>
                <field name="meal_type"/>
                <field name="item_ids"/>
                <field name="description"/>

                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="ribbon ribbon-top-right" t-if="record.meal_type.raw_value == 'breakfast'">
                                <span class="text-bg-warning">Breakfast</span>
                            </div>
                            <div class="ribbon ribbon-top-right" t-if="record.meal_type.raw_value == 'lunch'">
                                <span class="text-bg-success">Lunch</span>
                            </div>
                            <div class="ribbon ribbon-top-right" t-if="record.meal_type.raw_value == 'snacks'">
                                <span class="text-bg-info">Snacks</span>
                            </div>
                            <div class="ribbon ribbon-top-right" t-if="record.meal_type.raw_value == 'dinner'">
                                <span class="text-bg-primary">Dinner</span>
                            </div>

                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <i class="fa fa-cutlery text-primary"/> <field name="mess_id"/>
                                        </strong>
                                        <div class="text-muted">
                                            <i class="fa fa-calendar"/> <field name="date"/>
                                            (<field name="day_of_week"/>)
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_body mt-3">
                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div t-if="record.meal_type.raw_value == 'breakfast'" class="card bg-warning text-white">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-sun"/> Breakfast
                                                    </h6>
                                                    <small>Morning Meal</small>
                                                </div>
                                            </div>
                                            <div t-if="record.meal_type.raw_value == 'lunch'" class="card bg-success text-white">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-utensils"/> Lunch
                                                    </h6>
                                                    <small>Afternoon Meal</small>
                                                </div>
                                            </div>
                                            <div t-if="record.meal_type.raw_value == 'snacks'" class="card bg-info text-white">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-cookie-bite"/> Snacks
                                                    </h6>
                                                    <small>Evening Snacks</small>
                                                </div>
                                            </div>
                                            <div t-if="record.meal_type.raw_value == 'dinner'" class="card bg-primary text-white">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-moon"/> Dinner
                                                    </h6>
                                                    <small>Night Meal</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-light">
                                                <div class="card-body p-2">
                                                    <strong class="text-primary">
                                                        <i class="fa fa-list"/> Menu Items:
                                                    </strong>
                                                    <field name="item_ids" widget="many2many_tags"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.description.raw_value">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded">
                                                <strong class="text-muted">
                                                    <i class="fa fa-info-circle"/> Description:
                                                </strong>
                                                <div><field name="description"/></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_bottom mt-2">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Calendar View - Mess Menu -->
    <record id="mess_menu_view_calendar" model="ir.ui.view">
        <field name="name">mess.menu.view.calendar</field>
        <field name="model">mess.menu</field>
        <field name="arch" type="xml">
            <calendar string="Menu Calendar"
                      date_start="date"
                      mode="month"
                      color="meal_type"
                      quick_create="0"
                      event_limit="5">
                <field name="mess_id"/>
                <field name="meal_type"/>
                <field name="day_of_week"/>
            </calendar>
        </field>
    </record>

    <!-- Pivot View - Mess Menu -->
    <record id="mess_menu_view_pivot" model="ir.ui.view">
        <field name="name">mess.menu.view.pivot</field>
        <field name="model">mess.menu</field>
        <field name="arch" type="xml">
            <pivot string="Menu Analysis">
                <field name="day_of_week" type="row"/>
                <field name="meal_type" type="col"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View - Mess Menu -->
    <record id="mess_menu_view_graph" model="ir.ui.view">
        <field name="name">mess.menu.view.graph</field>
        <field name="model">mess.menu</field>
        <field name="arch" type="xml">
            <graph string="Menu Statistics" type="bar">
                <field name="meal_type"/>
            </graph>
        </field>
    </record>

    <!-- Action -->
    <record id="action_mess_menu" model="ir.actions.act_window">
        <field name="name">Mess Menu</field>
        <field name="res_model">mess.menu</field>
        <field name="view_mode">list,kanban,form,calendar,pivot,graph</field>
        <field name="context">{'search_default_filter_this_week': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create Mess Menu
            </p>
            <p>
                Plan and manage daily/weekly mess menus. System computes name (stored reference:
                "Mess Name - Date - Meal Type", e.g., "Central Mess - 2025-12-31 - Breakfast").
                Select mess_id (Many2one to hostel.mess, required, indexed, no-create). Enter date
                (date, default today, required). System auto-computes day_of_week (7 day selection,
                computed from date, stored, readonly): monday/tuesday/wednesday/thursday/friday/saturday/
                sunday. Select meal_type (4 options, required, radio widget): breakfast (Morning Meal -
                7-9 AM), lunch (Afternoon Meal - 12-2 PM), snacks (Evening Snacks - 4-6 PM), dinner
                (Night Meal - 7-9 PM). Select item_ids (Many2many to mess.item, many2many_tags widget,
                colored by item_type, no-create): Add multiple menu items for the meal. Enter description
                (html, optional, special instructions/allergens). System enforces unique constraint: One
                menu per mess + date + meal_type (cannot create duplicate). List view shows info decoration
                for weekends (saturday/sunday). Badge widgets for day_of_week and meal_type with 4
                decoration colors. Kanban view shows dynamic quadruple ribbon (Breakfast yellow, Lunch
                green, Snacks info, Dinner primary) and meal cards with icons and time info. Calendar view
                displays menus by month (date_start: date, color by meal_type, event_limit 5). Pivot view
                for analysis (day_of_week Ã— meal_type matrix). Graph view for statistics (bar chart by
                meal_type). Ordered by date desc then meal_type (most recent first, meal order). Default
                filter: This Week menus. Use for menu planning, student information, and dietary management.
                Full chatter support for communication.
            </p>
        </field>
    </record>

    <!-- Menu Item -->
<!--    <menuitem id="menu_mess_menu"-->
<!--              name="Daily Menu"-->
<!--              parent="menu_hostel_root"-->
<!--              action="action_mess_menu"-->
<!--              sequence="50"/>-->

</odoo>
