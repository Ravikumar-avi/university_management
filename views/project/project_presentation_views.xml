<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Form View - Project Presentation -->
    <record id="project_presentation_view_form" model="ir.ui.view">
        <field name="name">project.presentation.view.form</field>
        <field name="model">project.presentation</field>
        <field name="arch" type="xml">
            <form string="Project Presentation">
                <header>
                    <button name="action_mark_completed" string="Mark Completed" type="object"
                            class="btn-success"
                            invisible="state != 'scheduled'"/>
                    <button name="action_cancel" string="Cancel Presentation" type="object"
                            class="btn-danger"
                            invisible="state in ['completed', 'cancelled']"/>
                    <button name="action_reschedule" string="Reschedule" type="object"
                            class="btn-warning"
                            invisible="state != 'scheduled'"/>
                    <field name="state" widget="statusbar"
                           statusbar_visible="scheduled,completed"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_view_project" icon="fa-folder">
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_text">View</span>
                                <span class="o_stat_text">Project</span>
                            </div>
                        </button>
                        <button class="oe_stat_button" type="object" name="action_view_evaluation" icon="fa-check-square-o" invisible="not evaluation_id">
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_text">View</span>
                                <span class="o_stat_text">Evaluation</span>
                            </div>
                        </button>
                    </div>

                    <div class="oe_title">
                        <label for="name" string="Presentation"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Project Details">
                            <field name="project_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="presentation_type" widget="radio"/>
                        </group>
                        <group string="Schedule">
                            <label for="presentation_date" string="Date &amp; Time"/>
                            <div class="d-flex">
                                <field name="presentation_date" class="oe_inline" widget="date"/>
                                <field name="presentation_time" class="oe_inline ms-2" widget="float_time"/>
                            </div>
                            <label for="duration"/>
                            <div class="d-flex align-items-center">
                                <field name="duration" class="oe_inline"/>
                                <span class="ms-2 text-muted">minutes</span>
                            </div>
                            <field name="venue" placeholder="e.g. Conference Hall, Room 301"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Panel Members" name="panel_members">
                            <field name="panel_member_ids" nolabel="1">
                                <list string="Panel Members">
                                    <field name="name"/>
                                    <field name="faculty_code"/>
                                    <field name="designation_id"/>
                                    <field name="department_id"/>
                                    <field name="work_email" widget="email"/>
                                    <field name="work_mobile" widget="phone"/>
                                </list>
                            </field>
                        </page>

                        <page string="Students Present" name="students_present">
                            <field name="students_present" nolabel="1">
                                <list string="Students Present">
                                    <field name="name"/>
                                    <field name="registration_number"/>
                                    <field name="program_id"/>
                                    <field name="department_id"/>
                                    <field name="current_semester"/>
                                </list>
                            </field>
                        </page>

                        <page string="Evaluation" name="evaluation">
                            <group>
                                <field name="evaluation_id"
                                       options="{'no_create': True}"/>
                            </group>
                        </page>

                        <page string="Remarks" name="remarks">
                            <field name="remarks" nolabel="1"
                                   placeholder="Enter presentation remarks, observations, questions asked, student performance notes..."/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View - Project Presentation -->
    <record id="project_presentation_view_list" model="ir.ui.view">
        <field name="name">project.presentation.view.list</field>
        <field name="model">project.presentation</field>
        <field name="arch" type="xml">
            <list string="Project Presentations"
                  default_order="presentation_date desc"
                  multi_edit="1"
                  sample="1"
                  decoration-warning="state == 'scheduled'"
                  decoration-success="state == 'completed'"
                  decoration-muted="state == 'cancelled'">
                <field name="name"/>
                <field name="project_id"/>
                <field name="presentation_type" widget="badge"
                       decoration-warning="presentation_type == 'progress'"
                       decoration-info="presentation_type == 'viva'"
                       decoration-success="presentation_type == 'final'"/>
                <field name="presentation_date"/>
                <field name="presentation_time" widget="float_time" optional="show"/>
                <field name="duration" optional="hide"/>
                <field name="venue" optional="show"/>
                <field name="panel_member_ids" widget="many2many_tags" optional="hide"/>
                <field name="evaluation_id" optional="hide"/>
                <field name="state" widget="badge"
                       decoration-warning="state == 'scheduled'"
                       decoration-success="state == 'completed'"
                       decoration-muted="state == 'cancelled'"/>
            </list>
        </field>
    </record>

    <!-- Search View - Project Presentation -->
    <record id="project_presentation_view_search" model="ir.ui.view">
        <field name="name">project.presentation.view.search</field>
        <field name="model">project.presentation</field>
        <field name="arch" type="xml">
            <search string="Search Presentations">
                <field name="name"/>
                <field name="project_id"/>
                <field name="venue"/>
                <field name="panel_member_ids"/>

                <separator/>

                <filter name="filter_scheduled" string="Scheduled"
                        domain="[('state', '=', 'scheduled')]"/>
                <filter name="filter_completed" string="Completed"
                        domain="[('state', '=', 'completed')]"/>
                <filter name="filter_cancelled" string="Cancelled"
                        domain="[('state', '=', 'cancelled')]"/>

                <separator/>

                <filter name="filter_progress" string="Progress Presentation"
                        domain="[('presentation_type', '=', 'progress')]"/>
                <filter name="filter_viva" string="Viva Voce"
                        domain="[('presentation_type', '=', 'viva')]"/>
                <filter name="filter_final" string="Final Presentation"
                        domain="[('presentation_type', '=', 'final')]"/>

                <separator/>

                <filter name="filter_today" string="Today"
                        domain="[('presentation_date', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_week" string="This Week"
                        domain="[('presentation_date', '&gt;=', (context_today() - datetime.timedelta(days=context_today().weekday())).strftime('%Y-%m-%d')),
                                 ('presentation_date', '&lt;=', (context_today() + datetime.timedelta(days=6 - context_today().weekday())).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_month" string="This Month"
                        domain="[('presentation_date', '&gt;=', (context_today().replace(day=1)).strftime('%Y-%m-%d')),
                                 ('presentation_date', '&lt;=', ((context_today().replace(day=1) + datetime.timedelta(days=32)).replace(day=1) - datetime.timedelta(days=1)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_upcoming" string="Upcoming"
                        domain="[('presentation_date', '&gt;=', context_today().strftime('%Y-%m-%d'))]"/>

                <group expand="0" string="Group By">
                    <filter name="group_by_project" string="Project"
                            context="{'group_by': 'project_id'}"/>
                    <filter name="group_by_presentation_type" string="Presentation Type"
                            context="{'group_by': 'presentation_type'}"/>
                    <filter name="group_by_state" string="Status"
                            context="{'group_by': 'state'}"/>
                    <filter name="group_by_presentation_date" string="Presentation Date"
                            context="{'group_by': 'presentation_date'}"/>
                    <filter name="group_by_venue" string="Venue"
                            context="{'group_by': 'venue'}"/>
                </group>

                <searchpanel>
                    <field name="presentation_type" string="Type"
                           select="multi"
                           icon="fa-presentation"/>
                    <field name="state" string="Status"
                           select="multi"
                           icon="fa-flag"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Kanban View - Project Presentation -->
    <record id="project_presentation_view_kanban" model="ir.ui.view">
        <field name="name">project.presentation.view.kanban</field>
        <field name="model">project.presentation</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile"
                    default_group_by="state"
                    quick_create="false"
                    sample="1">
                <field name="id"/>
                <field name="name"/>
                <field name="project_id"/>
                <field name="presentation_type"/>
                <field name="presentation_date"/>
                <field name="presentation_time"/>
                <field name="duration"/>
                <field name="venue"/>
                <field name="panel_member_ids"/>
                <field name="evaluation_id"/>
                <field name="state"/>

                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <i class="fa fa-presentation"/> <field name="name"/>
                                        </strong>
                                        <div class="text-muted">
                                            <small>
                                                <i class="fa fa-folder"/> <field name="project_id"/>
                                            </small>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_body mt-3">
                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card text-white"
                                                 t-attf-class="{{
                                                    record.presentation_type.raw_value == 'progress' ? 'bg-warning' :
                                                    (record.presentation_type.raw_value == 'viva' ? 'bg-info' : 'bg-success')
                                                 }}">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <field name="presentation_type"/>
                                                    </h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-primary">
                                                    <i class="fa fa-calendar fa-lg"/>
                                                </div>
                                                <small class="text-muted">Date</small>
                                                <h6 class="mb-0"><field name="presentation_date"/></h6>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-success">
                                                    <i class="fa fa-clock-o fa-lg"/>
                                                </div>
                                                <small class="text-muted">Time</small>
                                                <h6 class="mb-0"><field name="presentation_time" widget="float_time"/></h6>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.venue.raw_value">
                                        <div class="col-12">
                                            <div class="card bg-secondary text-white">
                                                <div class="card-body p-2">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-map-marker"/> <field name="venue"/>
                                                    </h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded">
                                                <h6 class="mb-1 text-center">
                                                    <i class="fa fa-users text-primary"/> Panel Members
                                                </h6>
                                                <field name="panel_member_ids" widget="many2many_tags"/>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-warning">
                                                    <i class="fa fa-hourglass-half fa-lg"/>
                                                </div>
                                                <h6 class="mb-0"><field name="duration"/> min</h6>
                                                <small class="text-muted">Duration</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.evaluation_id.raw_value">
                                        <div class="col-12">
                                            <div class="alert alert-success mb-0 p-2 text-center">
                                                <small>
                                                    <i class="fa fa-check-circle"/> Evaluation Linked
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_bottom mt-2">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Calendar View - Project Presentation -->
    <record id="project_presentation_view_calendar" model="ir.ui.view">
        <field name="name">project.presentation.view.calendar</field>
        <field name="model">project.presentation</field>
        <field name="arch" type="xml">
            <calendar string="Presentation Calendar"
                      date_start="presentation_date"
                      mode="month"
                      color="presentation_type"
                      quick_create="0"
                      event_limit="5">
                <field name="name"/>
                <field name="project_id"/>
                <field name="presentation_type"/>
                <field name="venue"/>
                <field name="presentation_time"/>
                <field name="state"/>
            </calendar>
        </field>
    </record>

    <!-- Pivot View - Project Presentation -->
    <record id="project_presentation_view_pivot" model="ir.ui.view">
        <field name="name">project.presentation.view.pivot</field>
        <field name="model">project.presentation</field>
        <field name="arch" type="xml">
            <pivot string="Presentation Analysis">
                <field name="presentation_type" type="row"/>
                <field name="state" type="col"/>
                <field name="duration" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View - Project Presentation -->
    <record id="project_presentation_view_graph" model="ir.ui.view">
        <field name="name">project.presentation.view.graph</field>
        <field name="model">project.presentation</field>
        <field name="arch" type="xml">
            <graph string="Presentation Statistics" type="bar">
                <field name="presentation_type"/>
                <field name="presentation_date" interval="month"/>
            </graph>
        </field>
    </record>

    <!-- Action -->
    <record id="action_project_presentation" model="ir.actions.act_window">
        <field name="name">Project Presentations</field>
        <field name="res_model">project.presentation</field>
        <field name="view_mode">calendar,kanban,list,form,pivot,graph</field>
        <field name="context">{'search_default_filter_upcoming': 1, 'search_default_filter_scheduled': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Schedule Project Presentation
            </p>
            <p>
                Schedule and manage project presentations, viva voce, and evaluations. View name (char,
                computed from "{project_id.project_code} - {presentation_date}" via _compute_name with
                api.depends, stored). Select project_id (Many2one to student.project, required, tracked,
                indexed, no-create). Select presentation_type (3 options, required, tracked, radio widget):
                progress (Progress Presentation - warning/yellow badge), viva (Viva Voce - info badge),
                final (Final Presentation - success/green badge). Enter schedule: presentation_date (date,
                required, tracked, inline d-flex with presentation_time), presentation_time (float,
                float_time widget, 24-hour format, inline), duration (float minutes, default 20.0, inline
                with "minutes" text). Enter venue (char, placeholder "Conference Hall, Room 301"). Select
                panel_member_ids (Many2many to faculty.faculty, shown in embedded 6-field list: name/
                employee_code/designation_id/department_id/email with email widget/phone with phone
                widget). Select students_present (Many2many to student.student for attendance tracking,
                shown in embedded 5-field list: name/registration_number/program_id/department_id/
                semester_id). Link evaluation_id (Many2one to project.evaluation, no-create, shown in
                Evaluation tab with stat button "View Evaluation" check-square-o icon conditional if
                evaluation_id exists). Enter remarks (text, placeholder "Enter presentation remarks,
                observations, questions asked, student performance notes..."). Select state (3 options,
                default scheduled, tracked, statusbar widget): scheduled (Scheduled - warning/yellow row
                and badge), completed (Completed - success/green row and badge), cancelled (Cancelled -
                muted row and badge). Header has 3 action buttons: Mark Completed (scheduled→completed,
                success button), Cancel Presentation (any→cancelled except completed/cancelled, danger
                button), Reschedule (scheduled only, warning button). Form view button box has 2 stat
                buttons: View Project (folder icon), View Evaluation (check-square-o icon, conditional if
                evaluation_id). List view with 3-color row decorations: Warning/Yellow (scheduled),
                Success/Green (completed), Muted (cancelled). Badge widgets for presentation_type
                (3-color decorations) and state (3-color decorations). Float_time widget for
                presentation_time. Many2many_tags for panel_member_ids. Kanban view grouped by state
                showing presentation name (presentation icon), project name (folder icon, small),
                presentation type card (dynamic 3-color background: warning/progress, info/viva,
                success/final, centered), 2-card date/time grid (6/6): date card (light background,
                centered, calendar icon primary/blue) and time card (light background, centered, clock
                icon success/green, float_time widget), venue card (secondary/gray, map-marker icon,
                conditional), panel members card (light background, users icon primary/blue,
                many2many_tags widget), duration card (light background, centered, hourglass icon
                warning/yellow, shows duration + "min"), evaluation alert (success/green, check-circle
                icon, "Evaluation Linked", conditional if evaluation_id). Calendar view for scheduling
                (date_start: presentation_date, color by presentation_type, month mode, event_limit 5,
                quick_create disabled). Pivot view for analysis (presentation_type × state matrix,
                measure: duration). Graph view for statistics (bar chart, presentation_type vs.
                presentation_date by month interval). Ordered by presentation_date desc (most recent
                first). Default filters: Upcoming presentations and Scheduled status. Full chatter
                support for coordination.
            </p>
        </field>
    </record>

    <!-- Menu Item -->
<!--    <menuitem id="menu_project_presentation"-->
<!--              name="Presentations"-->
<!--              parent="menu_project_root"-->
<!--              action="action_project_presentation"-->
<!--              sequence="30"/>-->

</odoo>
