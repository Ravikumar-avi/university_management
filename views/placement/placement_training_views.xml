<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Form View - Placement Training -->
    <record id="placement_training_view_form" model="ir.ui.view">
        <field name="name">placement.training.view.form</field>
        <field name="model">placement.training</field>
        <field name="arch" type="xml">
            <form string="Placement Training">
                <header>
                    <button name="action_start" string="Start Training" type="object"
                            class="btn-primary"
                            invisible="state != 'scheduled'"/>
                    <button name="action_complete" string="Mark Completed" type="object"
                            class="btn-success"
                            invisible="state != 'ongoing'"/>
                    <button name="action_cancel" string="Cancel Training" type="object"
                            class="btn-danger"
                            invisible="state in ['completed', 'cancelled']"/>
                    <field name="state" widget="statusbar"
                           statusbar_visible="scheduled,ongoing,completed"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_placement_training" icon="fa-users">
                            <field name="total_students" widget="statinfo" string="Students"/>
                        </button>
                    </div>

                    <div class="oe_title">
                        <label for="name" string="Training Program Name"/>
                        <h1>
                            <field name="name" placeholder="e.g. Aptitude Training - Batch 2025"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Training Details">
                            <field name="training_type" widget="radio"/>
                            <field name="venue" placeholder="e.g. Computer Lab - Block A"/>
                        </group>
                        <group string="Duration">
                            <label for="start_date" string="Training Period"/>
                            <div class="d-flex">
                                <field name="start_date" class="oe_inline"/>
                                <span class="mx-2"> to </span>
                                <field name="end_date" class="oe_inline"/>
                            </div>
                            <field name="duration_days" string="Total Days"/>
                        </group>
                    </group>

                    <group>
                        <group string="Trainer">
                            <field name="trainer_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="external_trainer"
                                   placeholder="Enter external trainer name if applicable"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Description" name="description">
                            <field name="description" nolabel="1"
                                   placeholder="Enter training program description, objectives, methodology..."/>
                        </page>

                        <page string="Syllabus / Topics" name="syllabus">
                            <field name="syllabus" nolabel="1"
                                   placeholder="Enter syllabus and topics to be covered..."/>
                        </page>

                        <page string="Students Enrolled" name="students">
                            <field name="student_ids" nolabel="1">
                                <list string="Students">
                                    <field name="name"/>
                                    <field name="registration_number"/>
                                    <field name="program_id"/>
                                    <field name="department_id"/>
                                    <field name="current_semester"/>
                                    <field name="cgpa"/>
                                    <field name="email" widget="email"/>
                                    <field name="mobile" widget="phone"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View - Placement Training -->
    <record id="placement_training_view_list" model="ir.ui.view">
        <field name="name">placement.training.view.list</field>
        <field name="model">placement.training</field>
        <field name="arch" type="xml">
            <list string="Placement Training Programs"
                  default_order="start_date desc"
                  multi_edit="1"
                  sample="1"
                  decoration-info="state == 'scheduled'"
                  decoration-primary="state == 'ongoing'"
                  decoration-success="state == 'completed'"
                  decoration-muted="state == 'cancelled'">
                <field name="name"/>
                <field name="training_type" widget="badge"
                       decoration-info="training_type == 'aptitude'"
                       decoration-success="training_type == 'technical'"
                       decoration-warning="training_type in ['soft_skills', 'communication']"
                       decoration-primary="training_type in ['group_discussion', 'mock_interview']"
                       decoration-danger="training_type == 'resume_building'"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="duration_days" optional="show"/>
                <field name="trainer_id" optional="show"/>
                <field name="external_trainer" optional="hide"/>
                <field name="venue" optional="hide"/>
                <field name="total_students" optional="show"/>
                <field name="state" widget="badge"
                       decoration-info="state == 'scheduled'"
                       decoration-primary="state == 'ongoing'"
                       decoration-success="state == 'completed'"
                       decoration-muted="state == 'cancelled'"/>
            </list>
        </field>
    </record>

    <!-- Search View - Placement Training -->
    <record id="placement_training_view_search" model="ir.ui.view">
        <field name="name">placement.training.view.search</field>
        <field name="model">placement.training</field>
        <field name="arch" type="xml">
            <search string="Search Training Programs">
                <field name="name"/>
                <field name="trainer_id"/>
                <field name="external_trainer"/>
                <field name="training_type"/>

                <separator/>

                <filter name="filter_aptitude" string="Aptitude Training"
                        domain="[('training_type', '=', 'aptitude')]"/>
                <filter name="filter_technical" string="Technical Skills"
                        domain="[('training_type', '=', 'technical')]"/>
                <filter name="filter_soft_skills" string="Soft Skills"
                        domain="[('training_type', '=', 'soft_skills')]"/>
                <filter name="filter_communication" string="Communication Skills"
                        domain="[('training_type', '=', 'communication')]"/>
                <filter name="filter_gd" string="Group Discussion"
                        domain="[('training_type', '=', 'group_discussion')]"/>
                <filter name="filter_mock_interview" string="Mock Interviews"
                        domain="[('training_type', '=', 'mock_interview')]"/>
                <filter name="filter_resume" string="Resume Building"
                        domain="[('training_type', '=', 'resume_building')]"/>

                <separator/>

                <filter name="filter_scheduled" string="Scheduled"
                        domain="[('state', '=', 'scheduled')]"/>
                <filter name="filter_ongoing" string="Ongoing"
                        domain="[('state', '=', 'ongoing')]"/>
                <filter name="filter_completed" string="Completed"
                        domain="[('state', '=', 'completed')]"/>
                <filter name="filter_cancelled" string="Cancelled"
                        domain="[('state', '=', 'cancelled')]"/>

                <separator/>

                <filter name="filter_this_month" string="This Month"
                        domain="[('start_date', '&gt;=', (context_today().replace(day=1)).strftime('%Y-%m-%d')),
                                 ('start_date', '&lt;=', ((context_today().replace(day=1) + datetime.timedelta(days=32)).replace(day=1) - datetime.timedelta(days=1)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_year" string="This Year"
                        domain="[('start_date', '&gt;=', (context_today().replace(month=1, day=1)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_upcoming" string="Upcoming"
                        domain="[('start_date', '&gt;=', context_today().strftime('%Y-%m-%d')), ('state', '=', 'scheduled')]"/>

                <separator/>

                <filter name="filter_internal" string="Internal Trainer"
                        domain="[('trainer_id', '!=', False)]"/>
                <filter name="filter_external" string="External Trainer"
                        domain="[('external_trainer', '!=', False)]"/>

                <group expand="0" string="Group By">
                    <filter name="group_by_training_type" string="Training Type"
                            context="{'group_by': 'training_type'}"/>
                    <filter name="group_by_trainer" string="Trainer"
                            context="{'group_by': 'trainer_id'}"/>
                    <filter name="group_by_state" string="Status"
                            context="{'group_by': 'state'}"/>
                    <filter name="group_by_start_date" string="Start Date"
                            context="{'group_by': 'start_date'}"/>
                </group>

                <searchpanel>
                    <field name="training_type" string="Training Type"
                           select="multi"
                           icon="fa-graduation-cap"/>
                    <field name="state" string="Status"
                           select="multi"
                           icon="fa-flag"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Kanban View - Placement Training -->
    <record id="placement_training_view_kanban" model="ir.ui.view">
        <field name="name">placement.training.view.kanban</field>
        <field name="model">placement.training</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile"
                    default_group_by="state"
                    quick_create="false"
                    sample="1">
                <field name="id"/>
                <field name="name"/>
                <field name="training_type"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="duration_days"/>
                <field name="trainer_id"/>
                <field name="external_trainer"/>
                <field name="venue"/>
                <field name="total_students"/>
                <field name="state"/>

                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <i class="fa fa-graduation-cap"/> <field name="name"/>
                                        </strong>
                                    </div>
                                </div>

                                <div class="o_kanban_record_body mt-3">
                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card text-white"
                                                 t-attf-class="{{
                                                    record.training_type.raw_value == 'aptitude' ? 'bg-info' :
                                                    (record.training_type.raw_value == 'technical' ? 'bg-success' :
                                                    (record.training_type.raw_value in ['soft_skills', 'communication'] ? 'bg-warning' :
                                                    (record.training_type.raw_value in ['group_discussion', 'mock_interview'] ? 'bg-primary' : 'bg-danger')))
                                                 }}">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <field name="training_type"/>
                                                    </h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-primary">
                                                    <i class="fa fa-calendar-check fa-lg"/>
                                                </div>
                                                <small class="text-muted">Start Date</small>
                                                <h6 class="mb-0"><field name="start_date"/></h6>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-danger">
                                                    <i class="fa fa-calendar-times fa-lg"/>
                                                </div>
                                                <small class="text-muted">End Date</small>
                                                <h6 class="mb-0"><field name="end_date"/></h6>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-secondary text-white">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-clock-o"/>
                                                        <field name="duration_days"/> Days
                                                    </h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.trainer_id.raw_value or record.external_trainer.raw_value">
                                        <div class="col-12">
                                            <div class="card bg-primary text-white">
                                                <div class="card-body p-2">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-user-circle"/> Trainer
                                                    </h6>
                                                    <small t-if="record.trainer_id.raw_value">
                                                        <field name="trainer_id"/>
                                                    </small>
                                                    <small t-if="record.external_trainer.raw_value">
                                                        <field name="external_trainer"/>
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.venue.raw_value">
                                        <div class="col-12">
                                            <div class="card bg-info text-white">
                                                <div class="card-body p-2">
                                                    <small>
                                                        <i class="fa fa-map-marker"/> <field name="venue"/>
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-success">
                                                    <i class="fa fa-users fa-lg"/>
                                                </div>
                                                <h6 class="mb-0"><field name="total_students"/></h6>
                                                <small class="text-muted">Students Enrolled</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_bottom mt-2">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Calendar View - Placement Training -->
    <record id="placement_training_view_calendar" model="ir.ui.view">
        <field name="name">placement.training.view.calendar</field>
        <field name="model">placement.training</field>
        <field name="arch" type="xml">
            <calendar string="Training Calendar"
                      date_start="start_date"
                      date_stop="end_date"
                      mode="month"
                      color="training_type"
                      quick_create="0"
                      event_limit="5">
                <field name="name"/>
                <field name="training_type"/>
                <field name="trainer_id"/>
                <field name="venue"/>
                <field name="total_students"/>
                <field name="state"/>
            </calendar>
        </field>
    </record>

    <!-- Pivot View - Placement Training -->
    <record id="placement_training_view_pivot" model="ir.ui.view">
        <field name="name">placement.training.view.pivot</field>
        <field name="model">placement.training</field>
        <field name="arch" type="xml">
            <pivot string="Training Analysis">
                <field name="training_type" type="row"/>
                <field name="state" type="col"/>
                <field name="total_students" type="measure"/>
                <field name="duration_days" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View - Placement Training -->
    <record id="placement_training_view_graph" model="ir.ui.view">
        <field name="name">placement.training.view.graph</field>
        <field name="model">placement.training</field>
        <field name="arch" type="xml">
            <graph string="Training Statistics" type="bar">
                <field name="training_type"/>
                <field name="total_students" type="measure"/>
            </graph>
        </field>
    </record>

    <!-- Action -->
    <record id="action_placement_training" model="ir.actions.act_window">
        <field name="name">Placement Training</field>
        <field name="res_model">placement.training</field>
        <field name="view_mode">list,kanban,form,calendar,pivot,graph</field>
        <field name="context">{'search_default_filter_upcoming': 1, 'search_default_group_by_training_type': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create Pre-Placement Training Program
            </p>
            <p>
                Manage pre-placement training programs. Enter name (required, tracked, placeholder
                "Aptitude Training - Batch 2025"). Select training_type (7 options, required, radio
                widget): aptitude (Aptitude Training - info/blue badge), technical (Technical Skills -
                success/green badge), soft_skills (Soft Skills - warning/yellow badge), communication
                (Communication Skills - warning/yellow badge), group_discussion (Group Discussion -
                primary badge), mock_interview (Mock Interviews - primary badge), resume_building
                (Resume Building - danger/red badge). Enter duration: start_date (date, required,
                tracked), end_date (date, required, tracked, displayed as range "to" in d-flex),
                duration_days (integer, computed, auto-calculated as (end_date - start_date).days + 1).
                Enter trainer: trainer_id (Many2one to faculty.faculty, optional, no-create),
                external_trainer (char, placeholder "Enter external trainer name if applicable"). Enroll
                students: student_ids (Many2many to student.student, shows 8 fields: name/
                registration_number/program_id/department_id/current_semester/cgpa/email with email
                widget/mobile with phone widget). View total_students (integer, computed, count
                student_ids). Enter venue (char, placeholder "Computer Lab - Block A"). Enter
                description (html, placeholder "Enter training program description, objectives,
                methodology..."). Enter syllabus (html, placeholder "Enter syllabus and topics to be
                covered..."). Select state (4 options, default scheduled, tracked, statusbar widget):
                scheduled (Scheduled), ongoing (Ongoing), completed (Completed), cancelled (Cancelled).
                Header has 3 action buttons with visibility rules: Start Training (scheduled→ongoing,
                primary button), Mark Completed (ongoing→completed, success button), Cancel Training
                (any→cancelled except completed/cancelled, danger button). Form view button box has 1
                stat button: Students (users icon, statinfo widget showing total_students). List view
                with 4-color row decorations: Info/Blue (scheduled), Primary (ongoing), Success/Green
                (completed), Muted (cancelled). Badge widgets for training_type with 5-color decorations:
                Info/Blue (aptitude), Success/Green (technical), Warning/Yellow (soft_skills,
                communication), Primary (group_discussion, mock_interview), Danger/Red (resume_building).
                Badge widget for state with 4 decoration colors. Kanban view grouped by state showing
                training type card (dynamic color based on training_type: info/aptitude, success/
                technical, warning/soft_skills+communication, primary/group_discussion+mock_interview,
                danger/resume_building, centered), dates cards (2 cards 6/6 grid: start_date primary
                calendar-check icon, end_date danger calendar-times icon), duration card (secondary/
                gray, centered, clock icon, shows duration_days), trainer card (primary/blue,
                user-circle icon, shows trainer_id or external_trainer, conditional), venue card (info,
                map-marker icon, conditional), and students enrolled card (light background, centered,
                users icon success/green, shows total_students). Calendar view for training scheduling
                (date_start: start_date, date_stop: end_date, color by training_type, month mode,
                event_limit 5). Pivot view for analysis (training_type × state matrix, measures:
                total_students/duration_days). Graph view for statistics (bar chart, training_type vs.
                total_students). Ordered by start_date desc (most recent first). Default filters:
                Upcoming programs and Grouped by Training Type. Full chatter support for communication
                and tracking.
            </p>
        </field>
    </record>

    <!-- Menu Item -->
<!--    <menuitem id="menu_placement_training"-->
<!--              name="Placement Training"-->
<!--              parent="menu_placement_root"-->
<!--              action="action_placement_training"-->
<!--              sequence="30"/>-->

</odoo>
