<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Form View - Placement Drive -->
    <record id="placement_drive_view_form" model="ir.ui.view">
        <field name="name">placement.drive.view.form</field>
        <field name="model">placement.drive</field>
        <field name="arch" type="xml">
            <form string="Placement Drive">
                <header>
                    <button name="action_open_registration" string="Open Registration" type="object"
                            class="btn-primary"
                            invisible="state != 'draft'"/>
                    <button name="action_close_registration" string="Close Registration" type="object"
                            class="btn-warning"
                            invisible="state != 'registration_open'"/>
                    <button name="action_schedule" string="Schedule Drive" type="object"
                            class="btn-info"
                            invisible="state != 'registration_closed'"/>
                    <button name="action_start" string="Start Drive" type="object"
                            class="btn-success"
                            invisible="state != 'scheduled'"/>
                    <button name="action_complete" string="Complete" type="object"
                            class="btn-success"
                            invisible="state != 'ongoing'"/>
                    <button name="action_cancel" string="Cancel Drive" type="object"
                            class="btn-danger"
                            invisible="state in ['completed', 'cancelled']"/>
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,registration_open,registration_closed,scheduled,ongoing,completed"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_placement_application" icon="fa-users">
                            <field name="total_applications" widget="statinfo" string="Applications"/>
                        </button>
                        <button class="oe_stat_button" type="object" name="action_placement_drive" icon="fa-star">
                            <field name="shortlisted_count" widget="statinfo" string="Shortlisted"/>
                        </button>
                        <button class="oe_stat_button" type="object" name="action_placement_offer" icon="fa-gift">
                            <field name="total_offers" widget="statinfo" string="Offers"/>
                        </button>
                    </div>

                    <div class="oe_title">
                        <label for="name" string="Drive Name"/>
                        <h1>
                            <field name="name" placeholder="e.g. TCS Campus Drive 2025"/>
                        </h1>
                        <field name="code" readonly="1"/>
                    </div>

                    <group>
                        <group string="Company Details">
                            <field name="company_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="industry"/>
                            <field name="drive_date"/>
                            <field name="venue" placeholder="e.g. Main Auditorium"/>
                        </group>
                        <group string="Academic &amp; Coordinator">
                            <field name="academic_year_id"/>
                            <field name="coordinator_id"/>
                        </group>
                    </group>

                    <group>
                        <group string="Registration Period">
                            <field name="registration_start"/>
                            <field name="registration_end"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Job Details" name="job">
                            <group>
                                <group string="Position">
                                    <field name="job_title" placeholder="e.g. System Engineer"/>
                                    <field name="job_location" placeholder="e.g. Bangalore, Hyderabad, Pune"/>
                                    <field name="total_positions"/>
                                </group>
                                <group string="Salary Package (LPA)">
                                    <label for="ctc_min" string="CTC Range"/>
                                    <div class="d-flex">
                                        <field name="ctc_min" class="oe_inline"/>
                                        <span class="mx-2"> to </span>
                                        <field name="ctc_max" class="oe_inline"/>
                                    </div>
                                    <field name="currency_id" invisible="1"/>
                                </group>
                            </group>
                            <group string="Job Description">
                                <field name="job_description" nolabel="1"
                                       placeholder="Enter job description, roles, responsibilities..."/>
                            </group>
                            <group string="Selection Process/Rounds">
                                <field name="selection_rounds" nolabel="1"
                                       placeholder="Describe selection rounds: Aptitude Test, Technical Interview, HR Interview..."/>
                            </group>
                        </page>

                        <page string="Eligibility Criteria" name="eligibility">
                            <group>
                                <group string="Eligible Programs &amp; Departments">
                                    <field name="eligible_program_ids" widget="many2many_tags"
                                           placeholder="Select eligible programs..."/>
                                    <field name="eligible_department_ids" widget="many2many_tags"
                                           placeholder="Select eligible departments..."/>
                                </group>
                                <group string="Academic Requirements">
                                    <field name="min_cgpa" widget="float"/>
                                    <field name="max_backlogs"/>
                                </group>
                            </group>
                            <group string="Detailed Eligibility Criteria">
                                <field name="eligibility_criteria" nolabel="1"
                                       placeholder="Enter detailed eligibility criteria..."/>
                            </group>
                            <group string="Documents Required">
                                <field name="documents_required" nolabel="1"
                                       placeholder="List of documents required: Resume, Marksheets, ID Proof..."/>
                            </group>
                        </page>

                        <page string="Applications" name="applications">
                            <field name="application_ids" nolabel="1">
                                <list string="Student Applications">
                                    <field name="name"/>
                                    <field name="student_id"/>
                                    <field name="registration_number"/>
                                    <field name="program_id"/>
                                    <field name="department_id"/>
                                    <field name="cgpa"/>
                                    <field name="application_date"/>
                                    <field name="state" widget="badge"/>
                                </list>
                            </field>
                        </page>

                        <page string="Offers" name="offers">
                            <field name="offer_ids" nolabel="1">
                                <list string="Offer Letters">
                                    <field name="name"/>
                                    <field name="student_id"/>
                                    <field name="job_title"/>
                                    <field name="ctc" widget="monetary"/>
                                    <field name="offer_date"/>
                                    <field name="joining_date"/>
                                    <field name="state" widget="badge"/>
                                </list>
                            </field>
                        </page>

                        <page string="Notes" name="notes">
                            <field name="notes" nolabel="1" placeholder="Additional notes or instructions..."/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View - Placement Drive -->
    <record id="placement_drive_view_list" model="ir.ui.view">
        <field name="name">placement.drive.view.list</field>
        <field name="model">placement.drive</field>
        <field name="arch" type="xml">
            <list string="Placement Drives"
                  default_order="drive_date desc"
                  multi_edit="1"
                  sample="1"
                  decoration-info="state == 'draft'"
                  decoration-primary="state == 'registration_open'"
                  decoration-warning="state in ['registration_closed', 'scheduled']"
                  decoration-success="state in ['ongoing', 'completed']"
                  decoration-danger="state == 'cancelled'"
                  decoration-muted="state == 'cancelled'">
                <field name="code"/>
                <field name="name"/>
                <field name="company_id"/>
                <field name="industry" optional="hide" widget="badge"/>
                <field name="drive_date"/>
                <field name="venue" optional="hide"/>
                <field name="job_title"/>
                <field name="ctc_min" optional="show" widget="monetary"/>
                <field name="ctc_max" optional="show" widget="monetary"/>
                <field name="total_positions" optional="show"/>
                <field name="coordinator_id" optional="hide"/>
                <field name="total_applications" optional="show"/>
                <field name="shortlisted_count" optional="show"/>
                <field name="total_offers" optional="show"/>
                <field name="state" widget="badge"
                       decoration-info="state == 'draft'"
                       decoration-primary="state == 'registration_open'"
                       decoration-warning="state in ['registration_closed', 'scheduled']"
                       decoration-success="state in ['ongoing', 'completed']"
                       decoration-danger="state == 'cancelled'"/>
            </list>
        </field>
    </record>

    <!-- Search View - Placement Drive -->
    <record id="placement_drive_view_search" model="ir.ui.view">
        <field name="name">placement.drive.view.search</field>
        <field name="model">placement.drive</field>
        <field name="arch" type="xml">
            <search string="Search Placement Drives">
                <field name="name"/>
                <field name="code"/>
                <field name="company_id"/>
                <field name="job_title"/>
                <field name="coordinator_id"/>

                <separator/>

                <filter name="filter_draft" string="Draft"
                        domain="[('state', '=', 'draft')]"/>
                <filter name="filter_registration_open" string="Registration Open"
                        domain="[('state', '=', 'registration_open')]"/>
                <filter name="filter_registration_closed" string="Registration Closed"
                        domain="[('state', '=', 'registration_closed')]"/>
                <filter name="filter_scheduled" string="Scheduled"
                        domain="[('state', '=', 'scheduled')]"/>
                <filter name="filter_ongoing" string="Ongoing"
                        domain="[('state', '=', 'ongoing')]"/>
                <filter name="filter_completed" string="Completed"
                        domain="[('state', '=', 'completed')]"/>
                <filter name="filter_cancelled" string="Cancelled"
                        domain="[('state', '=', 'cancelled')]"/>

                <separator/>

                <filter name="filter_this_month" string="This Month"
                        domain="[('drive_date', '&gt;=', (context_today().replace(day=1)).strftime('%Y-%m-%d')),
                                 ('drive_date', '&lt;=', ((context_today().replace(day=1) + datetime.timedelta(days=32)).replace(day=1) - datetime.timedelta(days=1)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_year" string="This Year"
                        domain="[('drive_date', '&gt;=', (context_today().replace(month=1, day=1)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_upcoming" string="Upcoming"
                        domain="[('drive_date', '&gt;=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter name="filter_past" string="Past"
                        domain="[('drive_date', '&lt;', context_today().strftime('%Y-%m-%d'))]"/>

                <group expand="0" string="Group By">
                    <filter name="group_by_company" string="Company"
                            context="{'group_by': 'company_id'}"/>
                    <filter name="group_by_coordinator" string="Coordinator"
                            context="{'group_by': 'coordinator_id'}"/>
                    <filter name="group_by_state" string="Status"
                            context="{'group_by': 'state'}"/>
                    <filter name="group_by_drive_date" string="Drive Date"
                            context="{'group_by': 'drive_date'}"/>
                    <filter name="group_by_academic_year" string="Academic Year"
                            context="{'group_by': 'academic_year_id'}"/>
                </group>

                <searchpanel>
                    <field name="company_id" string="Company"
                           select="multi"
                           icon="fa-building"/>
                    <field name="state" string="Status"
                           select="multi"
                           icon="fa-flag"/>
                    <field name="academic_year_id" string="Academic Year"
                           select="multi"
                           icon="fa-calendar"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Kanban View - Placement Drive -->
    <record id="placement_drive_view_kanban" model="ir.ui.view">
        <field name="name">placement.drive.view.kanban</field>
        <field name="model">placement.drive</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile"
                    default_group_by="state"
                    quick_create="false"
                    sample="1">
                <field name="id"/>
                <field name="name"/>
                <field name="code"/>
                <field name="company_id"/>
                <field name="industry"/>
                <field name="drive_date"/>
                <field name="venue"/>
                <field name="job_title"/>
                <field name="job_location"/>
                <field name="ctc_min"/>
                <field name="ctc_max"/>
                <field name="total_positions"/>
                <field name="total_applications"/>
                <field name="shortlisted_count"/>
                <field name="total_offers"/>
                <field name="coordinator_id"/>
                <field name="state"/>

                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <i class="fa fa-briefcase"/> <field name="name"/>
                                        </strong>
                                        <div class="text-muted">
                                            <i class="fa fa-hashtag"/> <field name="code"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_body mt-3">
                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-primary text-white">
                                                <div class="card-body p-2">
                                                    <div class="d-flex align-items-center">
                                                        <i class="fa fa-building fa-2x me-2"/>
                                                        <div>
                                                            <h6 class="mb-0"><field name="company_id"/></h6>
                                                            <small t-if="record.industry.raw_value">
                                                                <field name="industry"/>
                                                            </small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-success text-white">
                                                <div class="card-body p-2">
                                                    <h6 class="mb-1">
                                                        <i class="fa fa-user-tie"/> <field name="job_title"/>
                                                    </h6>
                                                    <small t-if="record.job_location.raw_value">
                                                        <i class="fa fa-map-marker"/> <field name="job_location"/>
                                                    </small><br t-if="record.job_location.raw_value &amp; record.total_positions.raw_value"/>
                                                    <small t-if="record.total_positions.raw_value">
                                                        <i class="fa fa-users"/> <field name="total_positions"/> Positions
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.ctc_min.raw_value or record.ctc_max.raw_value">
                                        <div class="col-12">
                                            <div class="card bg-warning text-white">
                                                <div class="card-body p-2 text-center">
                                                    <h6 class="mb-0">
                                                        <i class="fa fa-money"/>
                                                        <field name="ctc_min"/> - <field name="ctc_max"/> LPA
                                                    </h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-4">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-primary">
                                                    <i class="fa fa-users fa-lg"/>
                                                </div>
                                                <h6 class="mb-0"><field name="total_applications"/></h6>
                                                <small class="text-muted">Applied</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-warning">
                                                    <i class="fa fa-star fa-lg"/>
                                                </div>
                                                <h6 class="mb-0"><field name="shortlisted_count"/></h6>
                                                <small class="text-muted">Shortlisted</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="bg-light p-2 rounded text-center">
                                                <div class="text-success">
                                                    <i class="fa fa-gift fa-lg"/>
                                                </div>
                                                <h6 class="mb-0"><field name="total_offers"/></h6>
                                                <small class="text-muted">Offers</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-info text-white">
                                                <div class="card-body p-2">
                                                    <small>
                                                        <i class="fa fa-calendar"/> <field name="drive_date"/>
                                                    </small>
                                                    <span t-if="record.venue.raw_value"> | </span>
                                                    <small t-if="record.venue.raw_value">
                                                        <i class="fa fa-map-marker"/> <field name="venue"/>
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2" t-if="record.coordinator_id.raw_value">
                                        <div class="col-12">
                                            <div class="card bg-secondary text-white">
                                                <div class="card-body p-2">
                                                    <small>
                                                        <i class="fa fa-user-circle"/> <field name="coordinator_id"/>
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_bottom mt-2">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Calendar View - Placement Drive -->
    <record id="placement_drive_view_calendar" model="ir.ui.view">
        <field name="name">placement.drive.view.calendar</field>
        <field name="model">placement.drive</field>
        <field name="arch" type="xml">
            <calendar string="Placement Drives Calendar"
                      date_start="drive_date"
                      mode="month"
                      color="company_id"
                      quick_create="0"
                      event_limit="5">
                <field name="name"/>
                <field name="company_id"/>
                <field name="job_title"/>
                <field name="state"/>
            </calendar>
        </field>
    </record>

    <!-- Pivot View - Placement Drive -->
    <record id="placement_drive_view_pivot" model="ir.ui.view">
        <field name="name">placement.drive.view.pivot</field>
        <field name="model">placement.drive</field>
        <field name="arch" type="xml">
            <pivot string="Drive Analysis">
                <field name="company_id" type="row"/>
                <field name="state" type="col"/>
                <field name="total_applications" type="measure"/>
                <field name="total_offers" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View - Placement Drive -->
    <record id="placement_drive_view_graph" model="ir.ui.view">
        <field name="name">placement.drive.view.graph</field>
        <field name="model">placement.drive</field>
        <field name="arch" type="xml">
            <graph string="Drive Statistics" type="bar">
                <field name="company_id"/>
                <field name="total_applications" type="measure"/>
                <field name="total_offers" type="measure"/>
            </graph>
        </field>
    </record>

    <!-- Action -->
    <record id="action_placement_drive" model="ir.actions.act_window">
        <field name="name">Placement Drives</field>
        <field name="res_model">placement.drive</field>
        <field name="view_mode">list,kanban,form,calendar,pivot,graph</field>
        <field name="context">{'search_default_filter_upcoming': 1, 'search_default_group_by_state': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create Placement Drive
            </p>
            <p>
                Manage campus placement drives. Enter name (required, tracked, e.g. "TCS Campus Drive
                2025"). System auto-generates code (drive code from sequence, unique, readonly). Select
                company_id (Many2one to placement.company, required, tracked, indexed, no-create). Shows
                industry (related from company_id, stored, readonly). Enter drive_date (date, required,
                tracked). Enter venue (char, placeholder "Main Auditorium"). Select academic_year_id
                (Many2one to university.academic.year, required). Define eligibility:
                eligible_program_ids (Many2many to university.program, many2many_tags widget),
                eligible_department_ids (Many2many to university.department, many2many_tags widget),
                min_cgpa (float, default 6.0), max_backlogs (integer, default 0), eligibility_criteria
                (html, placeholder). Enter job details: job_title (char, required, placeholder "System
                Engineer"), job_description (html, placeholder), job_location (char, placeholder
                "Bangalore, Hyderabad, Pune"). Enter salary package: ctc_min (monetary LPA), ctc_max
                (monetary LPA, displayed as range "to" in d-flex), currency_id (Many2one to res.currency,
                default company currency, invisible). Enter total_positions (integer, default 1). Enter
                selection_rounds (html, placeholder "Aptitude Test, Technical Interview, HR Interview...").
                Enter registration period: registration_start (date), registration_end (date). View
                application_ids (One2many to placement.application, shows 8 fields: name/student_id/
                registration_number/program_id/department_id/cgpa/application_date/state with badge
                widget). View 3 computed stats (@api.depends application_ids, application_ids.state,
                offer_ids): total_applications (count application_ids), shortlisted_count (count filtered
                application_ids where state in shortlisted/selected), total_offers (count offer_ids). View
                offer_ids (One2many to placement.offer, shows 7 fields: name/student_id/job_title/package
                monetary/offer_date/joining_date/state with badge widget). Select coordinator_id (Many2one
                to placement.coordinator). Select state (7 options, default draft, tracked, statusbar
                widget): draft (Draft), registration_open (Registration Open), registration_closed
                (Registration Closed), scheduled (Scheduled), ongoing (Ongoing), completed (Completed),
                cancelled (Cancelled). Enter documents_required (html, placeholder). Enter notes (text,
                placeholder). Header has 6 action buttons with visibility rules: Open Registration
                (draft→registration_open), Close Registration (registration_open→registration_closed),
                Schedule Drive (registration_closed→scheduled), Start Drive (scheduled→ongoing), Complete
                (ongoing→completed), Cancel Drive (any→cancelled except completed/cancelled). Unique code
                SQL constraint. Form view button box has 3 stat buttons: Applications (users icon,
                statinfo), Shortlisted (star icon, statinfo), Offers (gift icon, statinfo). List view with
                5-color row decorations: Info/Blue (draft), Primary (registration_open), Warning/Yellow
                (registration_closed, scheduled), Success/Green (ongoing, completed), Danger/Red
                (cancelled), Muted (cancelled). Badge widgets for industry &amp; state with 5 decoration
                colors. Kanban view grouped by state showing company card (primary/blue, building icon 2x),
                job card (success/green, user-tie icon, job_title/job_location/total_positions), salary
                card (warning/yellow, money icon, ctc_min - ctc_max LPA, conditional), stats cards (3 cards
                4/4/4 grid: applied users icon primary, shortlisted star icon warning, offers gift icon
                success), drive info card (info, calendar/map-marker icons, drive_date/venue), &amp;
                coordinator card (secondary/gray, user-circle icon, conditional). Calendar view for drive
                scheduling (date_start: drive_date, color by company_id, month mode, event_limit 5). Pivot
                view for analysis (company × state matrix, measures: total_applications/total_offers).
                Graph view for statistics (bar chart, company vs. total_applications/total_offers).
                Ordered by drive_date desc (most recent first). Default filters: Upcoming drives &amp;
                Grouped by Status. Full chatter support for communication &amp; tracking.
            </p>
        </field>
    </record>

    <!-- Menu Item -->
<!--    <menuitem id="menu_placement_drive"-->
<!--              name="Placement Drives"-->
<!--              parent="menu_placement_root"-->
<!--              action="action_placement_drive"-->
<!--              sequence="15"/>-->

</odoo>
