<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Form View - Placement Application -->
    <record id="placement_application_view_form" model="ir.ui.view">
        <field name="name">placement.application.view.form</field>
        <field name="model">placement.application</field>
        <field name="arch" type="xml">
            <form string="Placement Application">
                <header>
                    <button name="action_submit" string="Submit" type="object"
                            class="btn-primary"
                            invisible="state != 'draft'"/>
                    <button name="action_review" string="Start Review" type="object"
                            class="btn-primary"
                            invisible="state != 'submitted'"/>
                    <button name="action_shortlist" string="Shortlist" type="object"
                            class="btn-success"
                            invisible="state != 'under_review'"/>
                    <button name="action_select" string="Select" type="object"
                            class="btn-success"
                            invisible="state != 'shortlisted'"/>
                    <button name="action_reject" string="Reject" type="object"
                            class="btn-danger"
                            invisible="state in ['draft', 'rejected', 'withdrawn']"/>
                    <button name="action_withdraw" string="Withdraw" type="object"
                            class="btn-warning"
                            invisible="state in ['selected', 'rejected', 'withdrawn']"/>
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,submitted,under_review,shortlisted,selected"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name" string="Application Number"/>
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Student Details">
                            <field name="student_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="registration_number"/>
                            <field name="program_id"/>
                            <field name="department_id"/>
                            <field name="cgpa" widget="float"/>
                        </group>
                        <group string="Placement Drive">
                            <field name="drive_id"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="company_id"/>
                            <field name="application_date"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Resume &amp; Skills" name="resume">
                            <group>
                                <group string="Resume">
                                    <field name="resume" filename="resume_filename"/>
                                    <field name="resume_filename" invisible="1"/>
                                </group>
                                <group string="Skills &amp; Certifications">
                                    <field name="technical_skills"
                                           placeholder="e.g. Java, Python, React.js, MySQL, AWS..."/>
                                    <field name="certifications"
                                           placeholder="e.g. AWS Certified, Oracle Java Certified..."/>
                                </group>
                            </group>
                            <group>
                                <field name="cover_letter" nolabel="1"
                                       placeholder="Write your cover letter here..."/>
                            </group>
                            <group string="Supporting Documents">
                                <field name="document_ids" widget="many2many_binary" nolabel="1"/>
                            </group>
                        </page>

                        <page string="Selection Rounds" name="rounds">
                            <group>
                                <group string="Round 1 - Aptitude Test">
                                    <field name="round_1_status" widget="radio"/>
                                    <field name="aptitude_score" widget="float"/>
                                </group>
                                <group string="Round 2 - Technical Interview">
                                    <field name="round_2_status" widget="radio"/>
                                    <field name="technical_score" widget="float"/>
                                </group>
                            </group>
                            <group>
                                <group string="Round 3 - HR Interview">
                                    <field name="round_3_status" widget="radio"/>
                                    <field name="hr_score" widget="float"/>
                                </group>
                            </group>
                        </page>

                        <page string="Feedback &amp; Offer" name="feedback">
                            <group>
                                <group string="Offer Details">
                                    <field name="offer_id"/>
                                </group>
                            </group>
                            <group string="Feedback">
                                <field name="feedback" nolabel="1"
                                       placeholder="Company feedback &amp; interview performance..."/>
                            </group>
                            <group string="Remarks">
                                <field name="remarks" nolabel="1"
                                       placeholder="Additional remarks or notes..."/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View - Placement Application -->
    <record id="placement_application_view_list" model="ir.ui.view">
        <field name="name">placement.application.view.list</field>
        <field name="model">placement.application</field>
        <field name="arch" type="xml">
            <list string="Placement Applications"
                  default_order="application_date desc"
                  multi_edit="1"
                  sample="1"
                  decoration-info="state == 'draft'"
                  decoration-primary="state == 'submitted'"
                  decoration-warning="state in ['under_review', 'shortlisted']"
                  decoration-success="state == 'selected'"
                  decoration-danger="state == 'rejected'"
                  decoration-muted="state == 'withdrawn'">
                <field name="name"/>
                <field name="application_date"/>
                <field name="student_id"/>
                <field name="registration_number" optional="show"/>
                <field name="program_id" optional="hide"/>
                <field name="department_id" optional="show"/>
                <field name="drive_id"/>
                <field name="company_id"/>
                <field name="cgpa" optional="show"/>
                <field name="round_1_status" optional="hide" widget="badge"/>
                <field name="round_2_status" optional="hide" widget="badge"/>
                <field name="round_3_status" optional="hide" widget="badge"/>
                <field name="state" widget="badge"
                       decoration-info="state == 'draft'"
                       decoration-primary="state == 'submitted'"
                       decoration-warning="state in ['under_review', 'shortlisted']"
                       decoration-success="state == 'selected'"
                       decoration-danger="state == 'rejected'"
                       decoration-muted="state == 'withdrawn'"/>
            </list>
        </field>
    </record>

    <!-- Search View - Placement Application -->
    <record id="placement_application_view_search" model="ir.ui.view">
        <field name="name">placement.application.view.search</field>
        <field name="model">placement.application</field>
        <field name="arch" type="xml">
            <search string="Search Applications">
                <field name="name"/>
                <field name="student_id"/>
                <field name="registration_number"/>
                <field name="drive_id"/>
                <field name="company_id"/>

                <separator/>

                <filter name="filter_draft" string="Draft"
                        domain="[('state', '=', 'draft')]"/>
                <filter name="filter_submitted" string="Submitted"
                        domain="[('state', '=', 'submitted')]"/>
                <filter name="filter_under_review" string="Under Review"
                        domain="[('state', '=', 'under_review')]"/>
                <filter name="filter_shortlisted" string="Shortlisted"
                        domain="[('state', '=', 'shortlisted')]"/>
                <filter name="filter_selected" string="Selected"
                        domain="[('state', '=', 'selected')]"/>
                <filter name="filter_rejected" string="Rejected"
                        domain="[('state', '=', 'rejected')]"/>
                <filter name="filter_withdrawn" string="Withdrawn"
                        domain="[('state', '=', 'withdrawn')]"/>

                <separator/>

                <filter name="filter_round1_cleared" string="Round 1 Cleared"
                        domain="[('round_1_status', '=', 'cleared')]"/>
                <filter name="filter_round2_cleared" string="Round 2 Cleared"
                        domain="[('round_2_status', '=', 'cleared')]"/>
                <filter name="filter_round3_cleared" string="Round 3 Cleared"
                        domain="[('round_3_status', '=', 'cleared')]"/>

                <separator/>

                <filter name="filter_has_offer" string="Has Offer"
                        domain="[('offer_id', '!=', False)]"/>
                <filter name="filter_no_offer" string="No Offer"
                        domain="[('offer_id', '=', False)]"/>

                <separator/>

                <filter name="filter_this_month"
                        string="This Month"
                        domain="[('application_date', '>=', context_today().strftime('%Y-%m') + '-01')]"/>
                <filter name="filter_this_year"
                        string="This Year"
                        domain="[('application_date', '>=', context_today().strftime('%Y') + '-01-01')]"/>

                <group expand="0" string="Group By">
                    <filter name="group_by_student" string="Student"
                            context="{'group_by': 'student_id'}"/>
                    <filter name="group_by_drive" string="Placement Drive"
                            context="{'group_by': 'drive_id'}"/>
                    <filter name="group_by_company" string="Company"
                            context="{'group_by': 'company_id'}"/>
                    <filter name="group_by_program" string="Program"
                            context="{'group_by': 'program_id'}"/>
                    <filter name="group_by_department" string="Department"
                            context="{'group_by': 'department_id'}"/>
                    <filter name="group_by_state" string="Status"
                            context="{'group_by': 'state'}"/>
                    <filter name="group_by_application_date" string="Application Date"
                            context="{'group_by': 'application_date'}"/>
                </group>

                <searchpanel>
                    <field name="company_id" string="Company"
                           select="multi"
                           icon="fa-building"/>
                    <field name="state" string="Status"
                           select="multi"
                           icon="fa-flag"/>
                    <field name="program_id" string="Program"
                           select="multi"
                           icon="fa-graduation-cap"/>
                    <field name="department_id" string="Department"
                           select="multi"
                           icon="fa-sitemap"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Kanban View - Placement Application -->
    <record id="placement_application_view_kanban" model="ir.ui.view">
        <field name="name">placement.application.view.kanban</field>
        <field name="model">placement.application</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile"
                    default_group_by="state"
                    quick_create="false"
                    sample="1">
                <field name="id"/>
                <field name="name"/>
                <field name="student_id"/>
                <field name="registration_number"/>
                <field name="program_id"/>
                <field name="department_id"/>
                <field name="drive_id"/>
                <field name="company_id"/>
                <field name="cgpa"/>
                <field name="application_date"/>
                <field name="round_1_status"/>
                <field name="round_2_status"/>
                <field name="round_3_status"/>
                <field name="aptitude_score"/>
                <field name="technical_score"/>
                <field name="hr_score"/>
                <field name="state"/>

                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <i class="fa fa-file-text"/> <field name="name"/>
                                        </strong>
                                        <div class="text-muted">
                                            <i class="fa fa-calendar"/> <field name="application_date"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_body mt-3">
                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-primary text-white">
                                                <div class="card-body p-2">
                                                    <div class="d-flex align-items-center">
                                                        <i class="fa fa-user-graduate fa-2x me-2"/>
                                                        <div>
                                                            <h6 class="mb-0"><field name="student_id"/></h6>
                                                            <small><field name="registration_number"/></small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-success text-white">
                                                <div class="card-body p-2">
                                                    <div class="d-flex align-items-center">
                                                        <i class="fa fa-building fa-2x me-2"/>
                                                        <div>
                                                            <small>Drive</small>
                                                            <h6 class="mb-0"><field name="drive_id"/></h6>
                                                            <small><field name="company_id"/></small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <small class="text-muted">Program</small>
                                                <div><strong><field name="program_id"/></strong></div>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="bg-light p-2 rounded text-center">
                                                <small class="text-muted">CGPA</small>
                                                <div><h5 class="mb-0 text-primary"><field name="cgpa"/></h5></div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-2">
                                        <div class="col-12">
                                            <div class="card bg-info text-white">
                                                <div class="card-body p-2">
                                                    <h6 class="mb-2">
                                                        <i class="fa fa-tasks"/> Selection Rounds
                                                    </h6>
                                                    <div class="d-flex justify-content-between">
                                                        <div class="text-center">
                                                            <small>R1</small>
                                                            <div>
                                                                <span t-if="record.round_1_status.raw_value == 'cleared'" class="badge bg-success">
                                                                    <i class="fa fa-check"/>
                                                                </span>
                                                                <span t-if="record.round_1_status.raw_value == 'rejected'" class="badge bg-danger">
                                                                    <i class="fa fa-times"/>
                                                                </span>
                                                                <span t-if="record.round_1_status.raw_value == 'pending'" class="badge bg-warning">
                                                                    <i class="fa fa-clock"/>
                                                                </span>
                                                            </div>
                                                            <small t-if="record.aptitude_score.raw_value">
                                                                <field name="aptitude_score"/>
                                                            </small>
                                                        </div>
                                                        <div class="text-center" t-if="record.round_2_status.raw_value">
                                                            <small>R2</small>
                                                            <div>
                                                                <span t-if="record.round_2_status.raw_value == 'cleared'" class="badge bg-success">
                                                                    <i class="fa fa-check"/>
                                                                </span>
                                                                <span t-if="record.round_2_status.raw_value == 'rejected'" class="badge bg-danger">
                                                                    <i class="fa fa-times"/>
                                                                </span>
                                                                <span t-if="record.round_2_status.raw_value == 'pending'" class="badge bg-warning">
                                                                    <i class="fa fa-clock"/>
                                                                </span>
                                                            </div>
                                                            <small t-if="record.technical_score.raw_value">
                                                                <field name="technical_score"/>
                                                            </small>
                                                        </div>
                                                        <div class="text-center" t-if="record.round_3_status.raw_value">
                                                            <small>R3</small>
                                                            <div>
                                                                <span t-if="record.round_3_status.raw_value == 'cleared'" class="badge bg-success">
                                                                    <i class="fa fa-check"/>
                                                                </span>
                                                                <span t-if="record.round_3_status.raw_value == 'rejected'" class="badge bg-danger">
                                                                    <i class="fa fa-times"/>
                                                                </span>
                                                                <span t-if="record.round_3_status.raw_value == 'pending'" class="badge bg-warning">
                                                                    <i class="fa fa-clock"/>
                                                                </span>
                                                            </div>
                                                            <small t-if="record.hr_score.raw_value">
                                                                <field name="hr_score"/>
                                                            </small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="o_kanban_record_bottom mt-2">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Calendar View - Placement Application -->
    <record id="placement_application_view_calendar" model="ir.ui.view">
        <field name="name">placement.application.view.calendar</field>
        <field name="model">placement.application</field>
        <field name="arch" type="xml">
            <calendar string="Application Calendar"
                      date_start="application_date"
                      mode="month"
                      color="state"
                      quick_create="0"
                      event_limit="5">
                <field name="student_id"/>
                <field name="company_id"/>
                <field name="state"/>
            </calendar>
        </field>
    </record>

    <!-- Pivot View - Placement Application -->
    <record id="placement_application_view_pivot" model="ir.ui.view">
        <field name="name">placement.application.view.pivot</field>
        <field name="model">placement.application</field>
        <field name="arch" type="xml">
            <pivot string="Application Analysis">
                <field name="company_id" type="row"/>
                <field name="state" type="col"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View - Placement Application -->
    <record id="placement_application_view_graph" model="ir.ui.view">
        <field name="name">placement.application.view.graph</field>
        <field name="model">placement.application</field>
        <field name="arch" type="xml">
            <graph string="Application Statistics" type="bar">
                <field name="company_id"/>
                <field name="state" type="col"/>
            </graph>
        </field>
    </record>

    <!-- Action -->
    <record id="action_placement_application" model="ir.actions.act_window">
        <field name="name">Student Applications</field>
        <field name="res_model">placement.application</field>
        <field name="view_mode">list,kanban,form,calendar,pivot,graph</field>
        <field name="context">{'search_default_filter_this_year': 1, 'search_default_group_by_state': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create Placement Application
            </p>
            <p>
                Manage student placement applications. System auto-generates name (application number
                from sequence, unique, readonly). Select student_id (Many2one to student.student,
                required, tracked, indexed, no-create). Shows related fields: registration_number (from
                student_id), program_id (from student_id, stored), department_id (from student_id,
                stored), cgpa (from student_id). Select drive_id (Many2one to placement.drive, required,
                tracked, indexed, no-create). Shows related company_id (from drive_id, stored). Enter
                application_date (date, default today, required). Upload resume (binary, required,
                attachment, with resume_filename). Write cover_letter (html, placeholder). Enter
                technical_skills (text, placeholder "Java, Python, React.js...") &amp; certifications
                (text, placeholder "AWS Certified..."). Attach document_ids (Many2many to ir.attachment
                "Supporting Documents", many2many_binary widget). Track 3 selection rounds (each with 3
                options, tracked): round_1_status (Aptitude, default pending/cleared/rejected, radio
                widget), round_2_status (Technical, radio widget), round_3_status (HR, radio widget).
                Enter 3 scores: aptitude_score (float), technical_score (float), hr_score (float).
                Select state (7 options, default draft, tracked, statusbar widget): draft (Draft),
                submitted (Submitted), under_review (Under Review), shortlisted (Shortlisted), selected
                (Selected), rejected (Rejected), withdrawn (Withdrawn). Link offer_id (Many2one to
                placement.offer). Enter feedback (text, placeholder "Company feedback...") &amp; remarks
                (text, placeholder "Additional remarks..."). Header has 6 action buttons with visibility
                rules: Submit (draft→submitted), Start Review (submitted→under_review), Shortlist
                (under_review→shortlisted), Select (shortlisted→selected), Reject (any→rejected except
                draft/rejected/withdrawn), Withdraw (any→withdrawn except selected/rejected/withdrawn).
                2 SQL constraints: unique name, unique (student_id, drive_id) combination. Eligibility
                validation (_check_eligibility) raises ValidationError if student CGPA &lt; drive min_cgpa
                or student active_backlogs &gt; drive max_backlogs. List view with 6-color row decorations:
                Info/Blue (draft), Primary (submitted), Warning/Yellow (under_review, shortlisted),
                Success/Green (selected), Danger/Red (rejected), Muted/Gray (withdrawn). Badge widgets
                for round_1_status/round_2_status/round_3_status &amp; state with 6 decoration colors.
                Kanban view grouped by state showing student card (primary/blue, user-graduate icon 2x),
                drive card (success/green, building icon 2x), program/CGPA cards (2 cards 6/6 grid), &amp;
                selection rounds card (info/blue, tasks icon, 3 round badges with conditional icons:
                check/times/clock, conditional scores). Calendar view for application tracking
                (date_start: application_date, color by state, month mode, event_limit 5). Pivot view
                for analysis (company × state matrix). Graph view for statistics (bar chart, company vs.
                state stacked). Ordered by application_date desc (most recent first). Default filters:
                This Year applications &amp; Grouped by Status. Full chatter &amp; portal support for student
                access.
            </p>
        </field>
    </record>

    <!-- Menu Item -->
<!--    <menuitem id="menu_placement_application"-->
<!--              name="Student Applications"-->
<!--              parent="menu_placement_root"-->
<!--              action="action_placement_application"-->
<!--              sequence="20"/>-->

</odoo>
